従来のアプリ開発におけるドキュメント管理と、最新のAIコーディング（コンテキストエンジニアリング）の概念を統合し、**「AIエージェントと共に開発するための完全なドキュメント体系」**として再整理しました。

この構成は、人間が読むための「仕様書」であると同時に、AI（Claude CodeやCursorなど）が迷わずに自律的に開発を進めるための「外部記憶装置（External Memory）」としても機能します。

------

# 📘 AI時代のアプリ開発：統合ドキュメント＆コンテキスト管理ガイド

## 1. コアコンセプト：コンテキストエンジニアリング

現代の開発において、エンジニアの役割は「コードを書くこと」から「AIの記憶（コンテキスト）を管理すること」へシフトしました。AIの「短期記憶（コンテキストウィンドウ）」には限界（約20万トークン等）があり、情報が溢れると古い指示から忘却（スライディングウィンドウ）が始まります。

これを防ぐための4原則をドキュメント構成に反映させます。

1. **Write（記述）**: 脳内にある仕様をファイル（`docs/`）に書き出す。
2. **Select（選択）**: AIには必要なファイルだけを読み込ませる。
3. **Compress（圧縮）**: 履歴が肥大化したら要約し、エッセンスだけを残す。
4. **Isolate（分離）**: 調査や実験はサブエージェントで行い、メインの記憶を汚さない。

------

## 2. 📂 マスター・ドキュメントツリー（詳細版）

プロジェクトルート直下に、AI参照専用の `docs/` を配置し、その他の重厚な資料は各フォルダに整理する構成です。

Plaintext

```
Project_Root/
│
├── .cursorrules               # (Cursor用) AIの行動指針・プロジェクト固有のルール定義
├── CLAUDE.md                  # (Claude用) AIの行動指針・コーディング規約・テスト実行コマンド
│
├── docs/                      # 【AIの脳】AIが常に参照すべき「正解（Source of Truth）」
│   ├── requirements.md        # 要件定義（何を作るか、目的、ターゲット）
│   ├── architecture.md        # 基本設計（技術選定、DB構造、ディレクトリ構成）
│   ├── design_system.md       # UI/UXルール（カラー、フォント、共通コンポーネント）
│   ├── api_spec.md            # API仕様の概要（エンドポイント、データ型）
│   ├── progress.md            # 進捗管理（タスクリストとチェックボックス）
│   └── error_logs.md          # 解決済みエラーの知見・再発防止策
│
├── 00_Management/             # 【管理】人間用・プロジェクト管理
│   ├── project_charter.md     # プロジェクト憲章（予算・体制・期限）
│   ├── schedule.xlsx          # 詳細スケジュール・WBS
│   └── stakeholders.md        # 連絡体制図・会議議事録
│
├── 01_Design_Assets/          # 【体験】UI/UXデザイン詳細
│   ├── sitemap_ia.md          # 情報設計・画面遷移図（Mermaid記法推奨）
│   ├── wireframes/            # 各画面のワイヤーフレーム画像
│   └── prototype_links.md     # Figma等のプロトタイプURL集
│
├── 02_System_Details/         # 【構造】詳細な技術資料
│   ├── er_diagram.mermaid     # ER図（Mermaid形式ならAIが読める）
│   ├── infra_diagram.md       # インフラ構成図（AWS/GCP構成など）
│   └── sequence_diagrams/     # 複雑な処理のシーケンス図
│
├── 03_Quality_Test/           # 【品質】テスト・検証
│   ├── test_plan.md           # テスト計画書（範囲・方法）
│   ├── test_cases/            # テスト仕様書（単体・結合・E2E）
│   └── security_check.md      # 脆弱性診断レポート
│
└── 04_Operations/             # 【運用】リリース・保守
    ├── release_procedure.md   # リリース手順書・切り戻し手順
    ├── manual_user.md         # ユーザーマニュアル
    └── manual_admin.md        # 運用保守マニュアル（障害対応フロー）
```

------

## 3. 📝 重要ファイルの記述内容（AIへの指示書）

AIを自律的に動かすために、各ファイルに何を記述すべきかを定義します。

### A. 設定ファイル（ルールブック）

**ファイル名:** `CLAUDE.md` または `.cursorrules`

- **役割:** プロジェクトの「憲法」。AIがコードを書く前に必ず守るべきルール。
- **記述内容:**
  - **思考プロセス:** 「コードを書く前に必ず `docs/` を読み、整合性を確認せよ」
  - **技術スタック:** 使用する言語、フレームワークのバージョン。
  - **禁止事項:** 「`any` 型の使用禁止」「非推奨ライブラリの使用禁止」
  - **行動規範:** 「タスク完了後は `docs/progress.md` を更新すること」。

### B. `docs/requirements.md`（要件定義）

- **役割:** AIが目的を見失った時に立ち返る「北極星」。
- **記述内容:**
  - **アプリの目的:** 誰の、どんな課題を解決するか。
  - **機能一覧（Functional）:** 実装すべき機能の優先順位（Must/Should/Won't）。
  - **非機能要件:** パフォーマンス目標、セキュリティ基準。

### C. `docs/architecture.md`（設計図）

- **役割:** 技術的な矛盾や手戻りを防ぐためのガードレール。
- **記述内容:**
  - **ディレクトリ構造:** どのファイルがどこにあるべきかの定義。
  - **データモデル:** 主要なエンティティとその関係性。
  - **外部連携:** 使用するAPIやサービス（Firebase, Stripe等）。

### D. `docs/progress.md`（進捗管理・ステートマシン）

- **役割:** プロジェクトの「現在地」を記録する。AIに自己更新させることで、自律的な進行を促す。

- **記述内容:**

  - **フェーズ分けされたタスクリスト:**

    Markdown

    ```
    ## Phase 1: 初期設定
    - [x] プロジェクトの初期化
    - [ ] データベース接続設定
    ```

  - **現在のステータス:** 開発中、レビュー中、完了などの状態。

### E. `docs/error_logs.md`（知見の蓄積）

- **役割:** スライディングウィンドウによる「同じバグの繰り返し」を防ぐ。
- **記述内容:**
  - **発生したエラー:** エラーメッセージのコピー。
  - **原因:** なぜ起きたか。
  - **解決策:** どう修正したか。
  - **再発防止策:** 今後AIが気をつけるべき点。

------

## 4. 🔄 開発ワークフロー：ドキュメント駆動開発（SDD）

「いきなりコードを書く」のではなく、まず「ドキュメントを更新する」サイクルを回します。

1. **Instruction（指示）**:

   ユーザー：「`progress.md` の Phase 2 に着手してください」

2. **Select & Read（参照）**:

   AI：`docs/` 配下の要件と設計を読み込み、何を作るべきか理解する。

3. **Plan（計画）**:

   AI：「設計に基づき、以下のファイルを変更します」と提案。

4. **Implement（実装）**:

   AI：コードを記述・修正。

5. **Update State（更新）**:

   AI：実装完了後、`docs/progress.md` のチェックボックスをオンにする。

6. **Log Learning（学習）**:

   エラーが発生した場合、修正後に `docs/error_logs.md` へ知見を追記する。

------

## 5. 🚀 応用テクニック：コンテキストの分離と拡張

大規模な機能開発や複雑な調査が必要な場合の対処法です。

### サブエージェントによる分離（Isolation）

重いタスク（例：競合アプリのUI調査、複雑なアルゴリズムの検証）をメインのチャットで行うと、コンテキストが一気に埋まります。

- **手法:** `/agent` コマンド等を使用し、別の「人格」に調査を依頼する。
- **統合:** サブエージェントでの試行錯誤は捨て、**「結論（要約）」だけ**をメインのコンテキストに持ち帰らせる。

### MCP (Model Context Protocol) の活用

AIに外部ツール（ブラウザ、DBクライアント）を使わせ、リアルタイムな情報を取得させます。

- **手法:** `Chrome DevTools` 等のMCPサーバーを接続し、Webサイトの構造解析などを行わせる。
- **注意:** 生のHTMLなどをそのまま読み込ませず、必要な情報（CSSセレクタ等）だけを抽出して `docs/` に反映させる。

------

## 6. まとめ

AI開発におけるドキュメントは、単なる「記録」ではなく、AIを正しく動作させるための「制御プログラム」の一部です。

- **人間:** アーキテクトとして `docs/` を整備・監視する。
- **AI:** 実装者として `docs/` を読み、コードを書き、進捗を更新する。

この役割分担を明確にし、上記のフォルダ構成を導入することで、開発効率と品質は飛躍的に向上します。