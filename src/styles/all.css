:root {
  --bg:#0c0e13;--bg-1:#1e1e2e;--bg-2:#13161d;--bg-3:#1a1e28;--bg-4:#222733;
  --bg-s:var(--bg-2);--bd:var(--border);--fg:var(--text);
  --surface:#282e3c;--border:#2e3446;--border-light:#3a4158;
  --text:#e8ecf4;--text-2:#a4adc0;--text-3:#8fa0be;
  --accent:#3b82f6;--accent-soft:rgba(59,130,246,0.12);--accent-2:#22d3ee;
  --success:#34d399;
  --warn:#fbbf24;--warn-soft:rgba(251,191,36,0.1);--warn-text:#fbbf24;--danger:#f87171;
  --layer-1:#3b82f6;--layer-2:#8b5cf6;--layer-3:#10b981;--layer-3h:#f59e0b;--layer-4:#ef4444;--layer-5:#06b6d4;--layer-6:#f97316;--layer-7:#a855f7;
  --chip-bg:#1e2230;--chip-border:#2e3446;
  --accent-rgb:59,130,246;
  --radius:10px;--radius-lg:16px;
  --mono:'IBM Plex Mono',monospace;--sans:'IBM Plex Sans JP',-apple-system,sans-serif;
}
.compat-fixall{margin-left:auto;}
.compat-fixlv{margin-left:4px;}
[data-theme="light"]{
  --bg:#f5f7fa;--bg-1:#e8ecf0;--bg-2:#fff;--bg-3:#edf0f5;--bg-4:#e2e6ed;
  --bg-s:var(--bg-2);--bd:var(--border);--fg:var(--text);
  --surface:#d8dce5;--border:#cdd2dc;--border-light:#bfc5d2;
  --text:#1e222d;--text-2:#4a5168;--text-3:#4e5d78;
  --accent:#2563eb;--accent-soft:rgba(37,99,235,0.08);--accent-2:#0891b2;
  --success:#059669;
  --warn:#d97706;--warn-soft:rgba(217,119,6,0.06);--warn-text:#b45309;--danger:#dc2626;
  --layer-1:#2563eb;--layer-2:#7c3aed;--layer-3:#059669;--layer-3h:#d97706;--layer-4:#dc2626;--layer-5:#0891b2;--layer-6:#ea580c;--layer-7:#9333ea;
  --chip-bg:#e8ecf4;--chip-border:#d0d5e0;
  --accent-rgb:37,99,235;
}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{font-family:var(--sans);background:var(--bg);color:var(--text);min-height:100vh;-webkit-font-smoothing:antialiased;}
::-webkit-scrollbar{width:5px;}::-webkit-scrollbar-track{background:transparent;}::-webkit-scrollbar-thumb{background:var(--border-light);border-radius:3px;}
.app{max-width:1440px;margin:0 auto;height:100vh;display:flex;flex-direction:column;overflow:hidden;}

/* ═══ LAYOUT ═══ */
.topbar{display:flex;align-items:center;justify-content:space-between;padding:0 24px;height:50px;border-bottom:1px solid var(--border);background:var(--bg-2);position:sticky;top:0;z-index:100;}
.topbar-left{display:flex;align-items:center;gap:16px;min-width:0;flex:1;}
.topbar-brand{display:flex;align-items:center;gap:10px;flex-shrink:0;}
.topbar-brand svg{width:20px;height:20px;}
.topbar-brand span{font-weight:700;font-size:14px;letter-spacing:-0.03em;}
.topbar-brand small{font-size:11px;color:var(--text-3);font-weight:400;margin-left:2px;}

.topbar-right{display:flex;gap:6px;flex-shrink:0;}
.pstrip{height:3px;background:var(--bg-3);position:sticky;top:50px;z-index:99;}
.pstrip-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-2));transition:width .6s cubic-bezier(.4,0,.2,1);box-shadow:0 0 12px var(--accent);}

/* ═══ COMPONENTS ═══ */
.btn{padding:7px 16px;border:none;border-radius:7px;font-weight:600;font-size:12px;cursor:pointer;font-family:var(--sans);transition:all .15s;display:inline-flex;align-items:center;gap:5px;white-space:nowrap;}
.btn-p{background:var(--accent);color:#fff;}.btn-p:hover{background:#2563eb;transform:translateY(-1px);box-shadow:0 4px 12px rgba(59,130,246,0.3);}
.btn-s{background:var(--bg-3);color:var(--text-2);border:1px solid var(--border);}.btn-s:hover{background:var(--bg-4);color:var(--text);}
.btn-d{background:var(--success);color:#fff;}.btn-d:hover{background:#059669;}
.btn-g{background:transparent;color:var(--text-3);}.btn-g:hover{color:var(--text);}
.btn-sm{padding:5px 12px;font-size:11px;}.btn-xs{padding:3px 10px;font-size:10px;}
.theme-btn{background:none;border:none;font-size:16px;cursor:pointer;padding:4px 8px;border-radius:6px;transition:background .15s;color:var(--text);}
.theme-btn:hover{background:var(--bg-3);}

.onboard{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:20px 24px;gap:14px;text-align:center;overflow-y:auto;}
.onboard h1{font-size:28px;font-weight:700;letter-spacing:-0.03em;background:linear-gradient(135deg,var(--accent),var(--accent-2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.onboard p{color:var(--text-2);font-size:14px;max-width:560px;line-height:1.7;}
.info-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(170px,1fr));gap:10px;max-width:760px;width:100%;}
.icard{background:var(--bg-2);border:1px solid var(--border);border-radius:var(--radius);padding:16px;text-align:left;}
.icard h3,.icard h4{font-size:13px;margin-bottom:4px;}.icard p{font-size:11px;color:var(--text-3);line-height:1.5;}
.pillars-badge{display:flex;flex-wrap:wrap;gap:4px;justify-content:center;max-width:700px;}
.pbadge{padding:4px 12px;border-radius:20px;font-size:11px;font-weight:600;background:var(--bg-3);color:var(--text-2);border:1px solid var(--border);}
.start-zone{display:flex;flex-direction:column;gap:12px;align-items:center;width:100%;max-width:640px;}
.nameIn{width:100%;padding:12px 16px;border:1px solid var(--border);border-radius:var(--radius);background:var(--bg-3);color:var(--text);font-size:14px;font-family:var(--sans);outline:none;transition:border-color .2s;}
.nameIn:focus{border-color:var(--accent);}
.preset-row{display:flex;flex-wrap:wrap;gap:6px;justify-content:center;}
.prchip{padding:5px 14px;border-radius:20px;font-size:11px;font-weight:600;background:var(--chip-bg);color:var(--text-2);border:1px solid var(--chip-border);cursor:pointer;transition:all .15s;}
.prchip:hover{border-color:var(--accent);color:var(--accent);}
.prchip.on{background:var(--accent-soft);color:var(--accent);border-color:var(--accent);}
.prchip-cmp{background:color-mix(in srgb,var(--warn) 10%,transparent)!important;color:var(--warn)!important;border-color:color-mix(in srgb,var(--warn) 30%,transparent)!important;}
.cmp-selectors{display:flex;align-items:center;gap:8px;margin-bottom:16px;}
.cmp-selectors select{flex:1;padding:8px;border-radius:var(--radius);border:1px solid var(--border);background:var(--bg-1);color:var(--text);font-size:12px;}
.cmp-vs{font-weight:700;color:var(--warn);font-size:13px;}
.cmp-table{width:100%;font-size:11px;border-collapse:collapse;}
.cmp-table th{text-align:left;padding:6px 8px;background:var(--bg-3);font-size:11px;}
.cmp-table td{padding:5px 8px;border-bottom:1px solid var(--border);}
.cmp-label{font-weight:600;color:var(--text-3);min-width:70px;}
.cmp-diff td:not(.cmp-label){background:color-mix(in srgb,var(--warn) 6%,transparent);}
.preset-cat-bar{display:flex;flex-wrap:wrap;gap:4px;width:100%;padding:4px 0 8px;justify-content:center;}
.preset-cat-btn{padding:4px 12px;border-radius:20px;font-size:10px;font-weight:600;background:var(--chip-bg);color:var(--text-3);border:1px solid var(--chip-border);cursor:pointer;transition:all .15s;}
.preset-cat-btn:hover{border-color:var(--accent);color:var(--accent);}
.preset-cat-btn.active{background:var(--accent-soft);color:var(--accent);border-color:var(--accent);}
.preset-footer{display:flex;flex-wrap:wrap;gap:6px;justify-content:center;align-items:center;width:100%;padding:8px 0 4px;border-top:1px solid var(--border);margin-top:4px;}
.preset-storage-notice{width:100%;text-align:center;font-size:10px;color:var(--text-3);padding:4px 0;}

.ws-outer{display:flex;flex:1;overflow:hidden;gap:1px;background:var(--border);}
.ws{display:flex;flex:1;min-width:0;overflow:hidden;gap:1px;}
#ws{flex:1;flex-direction:column;overflow:hidden;}
/* ═══ SIDEBAR ═══ */
.sidebar{width:240px;flex-shrink:0;background:var(--bg-2);display:flex;flex-direction:column;overflow:hidden;transition:width 0.25s ease,opacity 0.25s ease;}
.sidebar.collapsed{width:0;opacity:0;pointer-events:none;}
.sb-head{display:flex;align-items:center;justify-content:flex-end;padding:6px 8px;border-bottom:1px solid var(--border);flex-shrink:0;}
.sb-toggle{background:none;border:1px solid var(--border);border-radius:6px;padding:4px 8px;cursor:pointer;font-size:11px;color:var(--text-3);transition:all 0.15s;}
.sb-toggle:hover{background:var(--bg-3);color:var(--text);}
.sb-body{display:flex;flex-direction:column;flex:1;overflow:hidden;}
.sb-tabs{display:flex;gap:2px;padding:6px 8px;border-bottom:1px solid var(--border);flex-shrink:0;}
.sb-tab{flex:1;padding:5px 0;border:none;border-radius:6px;background:none;cursor:pointer;font-size:14px;color:var(--text-3);transition:all 0.15s;}
.sb-tab.on{background:var(--bg-3);color:var(--accent);}
.sb-tab:hover:not(.on){background:var(--bg-3);}
.sb-section{display:flex;flex-direction:column;flex:1;overflow-y:auto;padding:8px;}
.sb-summary{overflow-y:auto;padding:6px 8px;}
.sb-sum-title{font-size:11px;font-weight:700;color:var(--text-3);padding:4px 4px 6px;letter-spacing:.3px;}
.sb-sum-list{list-style:none;margin:0 0 4px;padding:0 0 0 8px;}
.sb-sum-item{display:flex;align-items:center;gap:4px;padding:3px 4px;font-size:10px;color:var(--text-3);cursor:pointer;border-radius:4px;transition:all .15s;}
.sb-sum-item:hover{background:var(--bg-3);color:var(--text);}
.sb-sum-item.answered{color:var(--text-2);}
.sb-sum-item.current{background:var(--accent-soft);color:var(--accent);}
.sb-sum-mark{flex-shrink:0;font-size:10px;width:14px;text-align:center;}
.sb-sum-q{font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.sb-sum-ans{margin-left:auto;font-size:9px;color:var(--text-3);max-width:80px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.sb-progress{gap:6px;}
#sbPills{overflow-y:auto;flex-shrink:1;min-height:0;max-height:35vh;}
.sb-files{overflow-y:auto;padding:6px 6px;}
.sb-file-search{margin-bottom:6px;}
.sb-file-search input{width:100%;box-sizing:border-box;padding:5px 8px;font-size:11px;border:1px solid var(--border);border-radius:var(--radius);background:var(--bg-3);color:var(--text);font-family:var(--sans);outline:none;}
.sb-file-search input:focus{border-color:var(--accent);}
.sb-file-tree{list-style:none;font-size:11px;font-family:var(--mono);margin:0;padding:0;}
.sb-file-tree .ft-section-header{font-size:10px;font-weight:700;color:var(--text-3);padding:6px 4px 2px;letter-spacing:0.5px;}
.sb-file-tree .ft-folder{font-size:11px;color:var(--text-2);padding:2px 4px;font-weight:600;}
.sb-file-tree .ft-file{padding:1px 4px;}
.sb-file-tree .ft-file a{color:var(--text-2);text-decoration:none;display:block;padding:2px 4px;border-radius:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.sb-file-tree .ft-file a:hover{background:var(--bg-3);color:var(--text);}
.sb-file-tree .ft-file.active a{background:color-mix(in srgb,var(--accent) 15%,transparent);color:var(--accent);font-weight:600;}
.sb-empty{font-size:11px;color:var(--text-3);padding:8px 4px;}
.sb-key-banner{font-size:10px;font-weight:700;color:var(--success);padding:5px 6px 3px;background:color-mix(in srgb,var(--success) 8%,transparent);border-radius:var(--radius);margin-bottom:4px;letter-spacing:0.3px;}
.sb-key-files{list-style:none;margin:0 0 8px;padding:0;font-size:11px;font-family:var(--mono);}
.sb-key-files .ft-file a{color:var(--success);text-decoration:none;display:block;padding:2px 6px;border-radius:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.sb-key-files .ft-file a:hover{background:color-mix(in srgb,var(--success) 10%,transparent);}
.sb-pillar-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:4px;margin-top:8px;padding:0 2px;}
.sb-pillar-icon{background:none;border:1px solid var(--border);border-radius:6px;padding:4px 2px;cursor:pointer;font-size:14px;text-align:center;transition:all .2s;line-height:1;width:100%;}
.sb-pillar-icon:hover{background:var(--bg-3);border-color:var(--accent);}
.sb-pillar-icon.inactive{opacity:.3;cursor:default;pointer-events:none;}
.sb-pillar-icon.processing{border-color:var(--accent);animation:pillarPulse 1s infinite;opacity:1;}
.sb-pillar-icon.completed{border-color:var(--success);opacity:1;}
.sb-pillar-icon.completed:hover{background:color-mix(in srgb,var(--success) 10%,transparent);}
.sb-iconbar{width:40px;flex-shrink:0;background:var(--bg-2);display:flex;flex-direction:column;align-items:center;gap:4px;padding:8px 0;}
.sb-icon-btn{background:none;border:none;border-radius:6px;padding:6px;cursor:pointer;font-size:14px;color:var(--text-3);transition:all 0.15s;width:32px;height:32px;display:flex;align-items:center;justify-content:center;}
.sb-icon-btn:hover{background:var(--bg-3);color:var(--text);}
.panel-c{flex:1;display:flex;flex-direction:column;min-width:0;overflow:hidden;background:var(--bg);}
.panel-p{width:50%;display:flex;flex-direction:column;min-width:0;overflow:hidden;background:var(--bg);}
.badge{font-size:11px;padding:2px 10px;border-radius:10px;background:var(--accent-soft);color:var(--accent);font-weight:600;}
.cbody{flex:1;overflow-y:auto;padding:10px 14px;display:flex;flex-direction:column;gap:6px;}
.izone{border-top:1px solid var(--border);background:var(--bg-2);flex-shrink:0;}

.msg{display:flex;gap:10px;animation:fadeUp .3s ease;}
@keyframes fadeUp{from{opacity:0;transform:translateY(8px);}to{opacity:1;transform:translateY(0);}}

/* ═══ PREVIEW & EDITOR ═══ */
.prev-head{display:flex;align-items:center;gap:8px;padding:12px 20px;border-bottom:1px solid var(--border);background:var(--bg-2);}
.prev-head h3{font-size:14px;font-weight:600;flex:1;}
.prev-tabs{display:flex;gap:2px;background:var(--bg-3);border-radius:8px;padding:2px;}
.ptab{padding:4px 12px;border-radius:6px;font-size:11px;font-weight:600;color:var(--text-3);cursor:pointer;transition:all .15s;border:none;background:none;font-family:var(--sans);}
.ptab.on{background:var(--bg-2);color:var(--text);box-shadow:0 1px 3px rgba(0,0,0,0.1);}
.prev-body{flex:1;overflow-y:auto;padding:20px;}
.prev-body pre{background:var(--bg-3);border:1px solid var(--border);border-radius:var(--radius);padding:16px;font-family:var(--mono);font-size:12px;line-height:1.6;overflow-x:auto;white-space:pre-wrap;word-break:break-word;}
.file-tree{list-style:none;font-size:12px;font-family:var(--mono);}
.ft-search{margin-bottom:8px;}
.ft-search input{width:100%;padding:6px 10px;font-size:11px;border:1px solid var(--border);border-radius:var(--radius);background:var(--bg-2);color:var(--text);font-family:var(--sans);outline:none;}
.ft-search input:focus{border-color:var(--accent);}
.ft-clear-history{text-align:right;padding:2px 8px;}
.ft-clear-btn{background:none;border:1px solid var(--border);color:var(--text-3);font-size:11px;padding:2px 8px;border-radius:4px;cursor:pointer;opacity:0.7;transition:opacity 0.2s;}
.ft-clear-btn:hover{opacity:1;color:var(--danger);}
.file-tree li{padding:3px 0;color:var(--text-2);cursor:pointer;}.file-tree li:hover{color:var(--accent);}
.file-tree li.folder{color:var(--warn);font-weight:600;}
.file-tree li.active{color:var(--accent);font-weight:600;}

/* File Favorites & Recent (HCD: ②使いやすさ C継続利用) */
.ft-section-header{font-size:10px;text-transform:uppercase;letter-spacing:0.5px;color:var(--text-3);font-weight:700;padding:8px 0 4px;margin-top:8px;cursor:default!important;}
.ft-section-header:hover{color:var(--text-3)!important;}
.ft-separator{border-bottom:1px solid var(--border);margin:8px 0!important;padding:0!important;cursor:default!important;}
.ft-pinned,.ft-recent{position:relative;display:flex;align-items:center;justify-content:space-between;padding:6px 8px!important;background:var(--bg-2);border-radius:6px;margin:2px 0!important;transition:all .15s;}
.ft-pinned:hover,.ft-recent:hover{background:var(--bg-3);}
.ft-pin,.ft-unpin{background:none;border:none;color:var(--text-3);cursor:pointer;font-size:12px;padding:2px 6px;border-radius:4px;transition:all .15s;margin-left:8px;}
.ft-pin:hover,.ft-unpin:hover{color:var(--accent);background:var(--accent-soft);}
.ft-pin-active{color:var(--accent)!important;}
.tree-item{position:relative;display:flex;align-items:center;justify-content:space-between;}

.md-rendered{overflow:auto;max-height:calc(100vh - 200px);font-size:12px;line-height:1.6;padding:8px;}
.md-rendered h1,.md-rendered h2,.md-rendered h3{color:var(--text);margin:16px 0 8px;}
.md-rendered h1{font-size:16px;border-bottom:1px solid var(--border);padding-bottom:6px;}
.md-rendered h2{font-size:14px;} .md-rendered h3{font-size:13px;}
.md-rendered p,.md-rendered li{color:var(--text-2);font-size:12px;}
.md-rendered pre{background:var(--bg-2);padding:10px;border-radius:6px;overflow-x:auto;font-size:11px;}
.md-rendered code{font-family:var(--mono);font-size:11px;background:var(--bg-2);padding:1px 4px;border-radius:3px;}
.md-rendered pre code{background:none;padding:0;}
.md-rendered pre{position:relative;}
.code-copy-btn{position:absolute;top:4px;right:4px;background:var(--bg-3);border:1px solid var(--border);color:var(--text-3);cursor:pointer;font-size:12px;padding:2px 6px;border-radius:4px;opacity:0;transition:opacity .15s;z-index:1;}
.md-rendered pre:hover .code-copy-btn{opacity:1;}
.code-copy-btn:hover{background:var(--accent);color:#fff;border-color:var(--accent);}
.table-wrapper{position:relative;margin:8px 0;}
.table-copy-btn{position:absolute;top:4px;right:4px;background:var(--bg-3);border:1px solid var(--border);color:var(--text-3);cursor:pointer;font-size:12px;padding:2px 6px;border-radius:4px;opacity:0;transition:opacity .15s;z-index:1;}
.table-wrapper:hover .table-copy-btn{opacity:1;}
.table-copy-btn:hover{background:var(--accent);color:#fff;border-color:var(--accent);}
.mermaid-copy-btn{position:absolute;top:4px;right:4px;background:var(--bg-3);border:1px solid var(--border);color:var(--text-3);cursor:pointer;font-size:12px;padding:2px 6px;border-radius:4px;opacity:0;transition:opacity .15s;z-index:1;}
.md-rendered .mermaid:hover .mermaid-copy-btn{opacity:1;}
.mermaid-copy-btn:hover{background:var(--accent);color:#fff;border-color:var(--accent);}
.md-rendered table{width:100%;border-collapse:collapse;font-size:11px;margin:8px 0;}
.md-rendered th,.md-rendered td{border:1px solid var(--border);padding:4px 8px;text-align:left;}
.md-rendered th{background:var(--bg-2);font-weight:600;color:var(--text);}
.md-rendered .mermaid{position:relative;background:var(--bg-2);padding:16px;border-radius:8px;margin:12px 0;text-align:center;overflow-x:auto;}
.md-rendered .mermaid svg{max-width:100%;}
.md-rendered a{color:var(--accent);text-decoration:none;border-bottom:1px dotted var(--accent);cursor:pointer;}
.md-rendered a:hover{color:var(--text);border-bottom-color:var(--text);}
.md-rendered a[target="_blank"]::after{content:" ↗";font-size:0.8em;opacity:0.6;}
.md-rendered a.link-broken{color:var(--danger);border-bottom-color:var(--danger);opacity:0.7;}

.pillar-tabs{display:flex;gap:2px;flex-wrap:wrap;padding:8px 16px;background:var(--bg-2);border-bottom:1px solid var(--border);}
.piltab{padding:4px 10px;border-radius:6px;font-size:10px;font-weight:600;color:var(--text-3);cursor:pointer;border:none;background:none;font-family:var(--sans);transition:all .15s;}
.piltab.on{background:var(--accent-soft);color:var(--accent);}
.piltab:hover{color:var(--text);}

/* ═══ DASHBOARD ═══ */
.ctx-bar{height:6px;background:var(--bg-4);border-radius:3px;margin-top:8px;overflow:hidden;}
.ctx-bar-fill{height:100%;border-radius:3px;transition:width .6s;}

.road-week{font-size:10px;color:var(--text-3);font-weight:600;padding:2px 8px;background:var(--bg-4);border-radius:10px;flex-shrink:0;}

.mobtabs{display:none;border-bottom:1px solid var(--border);background:var(--bg-2);}
.mobtab{flex:1;text-align:center;padding:10px;font-size:12px;font-weight:600;color:var(--text-3);cursor:pointer;}.mobtab.on{color:var(--accent);border-bottom:2px solid var(--accent);}

.export-summary{display:flex;gap:16px;padding:12px 20px;font-size:12px;font-weight:600;color:var(--text-2);border-bottom:1px solid var(--border);flex-wrap:wrap;}
.export-summary span{display:flex;align-items:center;gap:4px;}
/* Quick Action Bar (HCD-optimized) */
.qbar{position:fixed;bottom:16px;left:50%;transform:translateX(-50%) translateY(100px);display:flex;gap:4px;padding:8px 12px;background:var(--bg-2);border:1px solid var(--border);border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.3);z-index:90;align-items:center;opacity:0;transition:all .2s ease-out;}
.qbar-visible{transform:translateX(-50%) translateY(0);opacity:1;animation:qbarSlideUp .2s ease-out;}
.qbar-hiding{animation:qbarSlideDown .2s ease-out;}
@keyframes qbarSlideUp{from{transform:translateX(-50%) translateY(100px);opacity:0;}to{transform:translateX(-50%) translateY(0);opacity:1;}}
@keyframes qbarSlideDown{from{transform:translateX(-50%) translateY(0);opacity:1;}to{transform:translateX(-50%) translateY(100px);opacity:0;}}

.qbar-group{display:flex;gap:4px;align-items:center;}
.qbar-sep{width:1px;height:20px;background:var(--border);margin:0 4px;}

.qbar-action{position:relative;display:flex;align-items:center;gap:6px;padding:6px 10px;border:none;border-radius:8px;font-size:11px;font-weight:600;cursor:pointer;background:var(--bg-3);color:var(--text);transition:all .15s;white-space:nowrap;}
.qbar-action:hover,.qbar-action:focus{background:var(--accent-soft);color:var(--accent);outline:2px solid var(--accent);outline-offset:2px;}
.qbar-action .qbar-icon{font-size:14px;}
.qbar-action .qbar-kb{display:none;font-size:9px;color:var(--text-3);margin-left:4px;padding:2px 4px;background:var(--bg-1);border-radius:4px;}
.qbar-action:hover .qbar-kb{display:inline;}

.qbar-primary{background:var(--accent);color:white;font-weight:700;}
.qbar-primary:hover,.qbar-primary:focus{background:var(--accent);color:white;transform:translateY(-2px);box-shadow:0 4px 12px rgba(var(--accent-rgb),.3);}

.qbar-minimize{padding:4px 8px;border:none;background:none;color:var(--text-3);cursor:pointer;font-size:14px;border-radius:6px;transition:all .15s;}
.qbar-minimize:hover,.qbar-minimize:focus{color:var(--text);background:var(--bg-3);outline:2px solid var(--accent);outline-offset:2px;}

/* Floating Action Button (FAB) */
.qbar-fab{position:fixed;bottom:20px;right:20px;width:56px;height:56px;border-radius:50%;background:var(--accent);color:white;border:none;box-shadow:0 4px 16px rgba(0,0,0,0.3);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:24px;z-index:90;transition:all .2s;animation:fabBounceIn .3s ease-out;}
.qbar-fab:hover{transform:scale(1.1);box-shadow:0 6px 20px rgba(0,0,0,0.4);}
.qbar-fab:focus{outline:2px solid white;outline-offset:4px;}
@keyframes fabBounceIn{from{transform:scale(0);opacity:0;}60%{transform:scale(1.15);}to{transform:scale(1);opacity:1;}}

/* Responsive: Mobile vertical layout */
.export-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;padding:20px;}
.export-card{background:var(--bg-3);border:1px solid var(--border);border-radius:var(--radius);padding:20px;text-align:center;cursor:pointer;transition:all .15s;}
.export-card-danger{border-color:color-mix(in srgb,var(--danger) 25%,transparent);opacity:0.7;}.export-card-danger:hover{border-color:var(--danger);background:color-mix(in srgb,var(--danger) 6%,transparent);opacity:1;}
.export-card-regen{border-color:var(--accent);border-style:dashed;}
.export-card:hover{border-color:var(--accent);transform:translateY(-2px);}
.export-card .icon{font-size:32px;margin-bottom:8px;}
.export-card h4{font-size:13px;margin-bottom:4px;}
.export-card p{font-size:11px;color:var(--text-3);}

/* Export Grid Enhancement (HCD: ③認知負荷 ①目的達成) */
.export-hero{position:relative;margin:20px;padding:24px;background:linear-gradient(135deg,var(--accent),color-mix(in srgb,var(--accent) 70%,black));border-radius:12px;cursor:pointer;display:flex;align-items:center;gap:20px;transition:all .2s;box-shadow:0 4px 16px rgba(0,0,0,0.15);}
.export-hero:hover{transform:translateY(-4px);box-shadow:0 8px 24px rgba(0,0,0,0.25);}
.export-hero-badge{position:absolute;top:12px;right:12px;background:white;color:var(--accent);padding:4px 12px;border-radius:12px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;}
.export-hero-icon{font-size:48px;flex-shrink:0;}
.export-hero-content h3{font-size:18px;color:white;margin-bottom:6px;}
.export-hero-content p{font-size:13px;color:rgba(255,255,255,0.9);line-height:1.5;}

.export-group-label{margin:20px 20px 12px;font-size:12px;font-weight:700;color:var(--text-2);text-transform:uppercase;letter-spacing:1px;display:flex;align-items:center;gap:8px;}
.export-grid-compact{padding:0 20px 20px;}

.export-danger-zone{margin:20px;padding:16px;background:color-mix(in srgb,var(--danger) 5%,transparent);border:1px dashed var(--danger);border-radius:8px;}
.export-danger-label{font-size:11px;font-weight:700;color:var(--danger);margin-bottom:12px;text-transform:uppercase;letter-spacing:0.5px;display:flex;align-items:center;gap:6px;}
.export-danger-zone .export-card{margin:0;}

/* ═══ OVERLAYS & MODALS ═══ */
.help-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:200;display:none;align-items:center;justify-content:center;}
.help-overlay.show{display:flex;}
.help-modal{background:var(--bg-2);border:1px solid var(--border);border-radius:var(--radius-lg);width:90vw;max-width:800px;height:80vh;display:flex;overflow:hidden;}
.help-nav{width:200px;background:var(--bg-3);border-right:1px solid var(--border);overflow-y:auto;padding:12px 0;flex-shrink:0;}
.help-nav a{display:block;padding:8px 16px;font-size:12px;color:var(--text-2);text-decoration:none;transition:all .15s;}
.help-nav a:hover{background:var(--bg-4);color:var(--text);}
.help-nav a.on{background:var(--accent-soft);color:var(--accent);font-weight:600;}
.help-search{width:calc(100% - 16px);margin:8px;padding:6px 10px;font-size:11px;border:1px solid var(--border);border-radius:var(--radius);background:var(--bg-1,var(--bg));color:var(--text);outline:none;}
.help-search:focus{border-color:var(--accent);}
#helpPopup{position:fixed;z-index:300;background:var(--bg-2);border:1px solid var(--border);border-radius:var(--radius);padding:14px 18px;max-width:340px;box-shadow:0 8px 32px rgba(0,0,0,0.25);font-size:12px;color:var(--text);}
#helpPopup h4{font-size:13px;margin-bottom:6px;color:var(--text);}
#helpPopup p{font-size:12px;color:var(--text-2);line-height:1.6;margin-bottom:6px;}
.hp-close{position:absolute;top:6px;right:8px;background:none;border:none;color:var(--text-3);cursor:pointer;font-size:14px;padding:2px 6px;border-radius:4px;}
.hp-close:hover{background:var(--bg-3);color:var(--text);}
.hp-ex{background:var(--bg-3);padding:8px 10px;border-radius:6px;font-size:11px;color:var(--accent);line-height:1.5;}
.hp-link{display:block;margin-top:8px;font-size:11px;color:var(--accent);text-decoration:none;}
.hp-link:hover{text-decoration:underline;}
.help-nav a.dim{opacity:0.3;pointer-events:none;}
.help-tour-btn{display:block;width:calc(100% - 16px);margin:8px;padding:6px 10px;font-size:11px;font-weight:600;background:var(--bg-3);color:var(--text-2);border:1px solid var(--border);border-radius:var(--radius);cursor:pointer;text-align:center;transition:all .15s;}
.help-tour-btn:hover{background:var(--accent-soft);color:var(--accent);border-color:var(--accent);}
mark{background:var(--accent-soft);color:var(--accent);padding:0 2px;border-radius:2px;}
.help-body{flex:1;overflow-y:auto;padding:24px;}
.help-body h2{font-size:18px;margin-bottom:12px;}.help-body h3{font-size:14px;margin:16px 0 8px;color:var(--accent);}
.help-body p{font-size:13px;line-height:1.7;margin-bottom:10px;color:var(--text-2);}
.help-body code{font-family:var(--mono);background:var(--bg-3);padding:2px 6px;border-radius:4px;font-size:12px;}
.help-body table{width:100%;border-collapse:collapse;margin:10px 0;font-size:12px;}
.help-body th,.help-body td{padding:8px 12px;border:1px solid var(--border);text-align:left;}
.help-body th{background:var(--bg-3);font-weight:600;}
.hg-flow{display:flex;align-items:center;gap:6px;padding:10px;background:var(--bg-3);border-radius:8px;margin:8px 0;overflow-x:auto;}
.hg-n{padding:6px 8px;border-radius:6px;font-size:10px;text-align:center;font-weight:600;line-height:1.4;white-space:nowrap;}
.hg-a{color:var(--text-3);font-size:12px;flex-shrink:0;}
.hg-b{background:var(--accent-soft);color:var(--accent);border:1px solid color-mix(in srgb,var(--accent) 25%,transparent);}
.hg-c{background:color-mix(in srgb,var(--accent-2) 10%,transparent);color:var(--accent-2);border:1px solid color-mix(in srgb,var(--accent-2) 25%,transparent);}
.hg-p{background:color-mix(in srgb,#a855f7 10%,transparent);color:#a855f7;border:1px solid color-mix(in srgb,#a855f7 25%,transparent);}
.hg-g{background:color-mix(in srgb,var(--success) 10%,transparent);color:var(--success);border:1px solid color-mix(in srgb,var(--success) 25%,transparent);}

.app-footer{text-align:center;padding:16px;font-size:11px;color:var(--text-3);border-top:1px solid var(--border);}

/* ═══ RESPONSIVE ═══ */
@media(max-width:1024px){.panel-p{width:45%;}.panel-c{flex:1;}.ctx-summary{grid-template-columns:repeat(2,1fr);}.model-grid{grid-template-columns:repeat(2,1fr);}.exp-compare{grid-template-columns:1fr;}.onboard h1{font-size:24px;}.info-grid{grid-template-columns:repeat(2,1fr);}.sidebar{width:200px;}}
@media(max-width:768px){
  .topbar{padding:0 12px;}
  .mobtabs{display:flex;}
  .sidebar,.sb-iconbar{display:none;}
  /* C-1: WCAG 2.5.5 touch targets (44px minimum) */
  .piltab,.mobtab,.btn-s,.btn-xs,.field-cat-btn,.scale-btn,.preset-mode-btn{min-height:44px;}
  .pd-q{min-height:44px;}
  .sb-file-tree .ft-file a{min-height:44px;display:flex;align-items:center;box-sizing:border-box;}
  /* C-4: export hero flex-wrap */
  .export-hero{flex-wrap:wrap;}
  .ws-outer{gap:0;background:var(--bg);}
  .ws{gap:0;flex-direction:column;}.panel-p{width:100%;display:none;}.panel-p.show{display:flex;}
  .panel-c.hide{display:none;}
  /* Quick Action Bar mobile */
  .qbar{flex-direction:column;bottom:auto;top:50%;left:auto;right:16px;transform:translateY(-50%) translateX(100px);}
  .qbar-visible{transform:translateY(-50%) translateX(0);}
  .qbar-hiding{animation:qbarSlideRight .2s ease-out;}
  @keyframes qbarSlideRight{from{transform:translateY(-50%) translateX(0);}to{transform:translateY(-50%) translateX(100px);}}
  .qbar-group{flex-direction:column;}
  .qbar-sep{width:20px;height:1px;margin:4px 0;}
  .qbar-action .qbar-label{display:none;}
  .qbar-action{padding:8px;}
  .qbar-action .qbar-kb{display:none!important;}
  .help-modal{flex-direction:column;width:95vw;height:90vh;}.help-nav{width:100%;height:auto;max-height:120px;border-right:none;border-bottom:1px solid var(--border);display:flex;overflow-x:auto;padding:8px;}
  .help-nav a{white-space:nowrap;}
  .info-grid{grid-template-columns:1fr 1fr;}
  .onboard h1{font-size:22px;}
  .exp-select{flex-direction:column;gap:8px;}
  .exp-select select{width:100%;}
  .exp-ranking{gap:6px;}
  .exp-rank-row{flex-wrap:wrap;}
  /* Dashboard */
  .ctx-summary{grid-template-columns:1fr 1fr;}
  .model-grid{grid-template-columns:1fr;}
  .dash-fbar-name{width:70px;font-size:10px;}
  .dg{padding:8px 10px;margin-bottom:4px;}
  .dg-bar{grid-template-columns:55px 1fr 24px;gap:4px;}
  .dg-lbl{font-size:10px;}
  .dg-track{height:12px;}
  .dg-cnt{font-size:10px;}
  /* AI Launcher */
  .launch-stats{grid-template-columns:1fr 1fr;}
  .launch-folders{gap:4px;}
  .launch-models{grid-template-columns:1fr 1fr;}
  .launch-tpl{padding:8px;}
  /* Tech DB */
  .tech-table th:nth-child(3),.tech-table td:nth-child(3){display:none;}
  .tech-filter{flex-direction:column;gap:6px;}
  .tech-filter select,.tech-filter input{width:100%;}
  /* Diff */
  .diff-header{flex-direction:column;gap:4px;}
  .diff-body{font-size:10px;}
  /* KB overlay */
  .kb-modal{width:95vw;padding:16px;}
  /* Roadmap */
  .road-layer h3{font-size:12px;padding:6px 10px;}
  .road-task{font-size:11px;padding:6px 8px;}
  .road-progress{padding:12px;}
}

.spin{animation:spin 1s linear infinite;}
@keyframes spin{to{transform:rotate(360deg);}}

.tech-table{width:100%;border-collapse:collapse;font-size:11px;}
.tech-table th{position:sticky;top:0;background:var(--bg-2);padding:6px 8px;text-align:left;font-weight:600;border-bottom:2px solid var(--accent);font-size:10px;text-transform:uppercase;letter-spacing:0.05em;}
.tech-table td{padding:5px 8px;border-bottom:1px solid var(--border);}
.tech-table tr:hover{background:var(--bg-3);}
.tech-filter{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:10px;}
.tech-filter select,.tech-filter input{padding:5px 10px;border:1px solid var(--border);border-radius:6px;background:var(--bg-3);color:var(--text);font-size:11px;font-family:var(--sans);}
.req-badge{display:inline-block;padding:1px 6px;border-radius:8px;font-size:9px;font-weight:700;}

/* Context Dashboard */
.ctx-summary{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:16px;}
.ctx-stat{background:var(--bg-3);border:1px solid var(--border);border-radius:var(--radius);padding:12px;text-align:center;}
.ctx-stat .num{font-size:24px;font-weight:700;color:var(--accent);}
.ctx-stat .lbl{font-size:10px;color:var(--text-3);margin-top:4px;}
.model-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px;}
.model-card{background:var(--bg-3);border:1px solid var(--border);border-radius:var(--radius);padding:12px;}
.model-card h4{font-size:12px;margin-bottom:6px;}.model-card .fit{font-size:20px;font-weight:700;}
.fit-high{color:var(--success);}.fit-mid{color:var(--warn);}.fit-low{color:var(--danger);}

.dash-head{margin-bottom:12px;}
.dash-head h3{font-size:14px;margin-bottom:4px;}
.dash-head p{font-size:11px;color:var(--text-3);}
.dash-h4{font-size:12px;margin-bottom:8px;}
.dash-h4-mt{font-size:12px;margin:16px 0 8px;}
.dash-model-ctx{font-size:11px;color:var(--text-3);margin-top:4px;}
.dash-model-pct{font-size:10px;color:var(--text-3);margin-top:2px;}
.dash-fbar-row{display:flex;align-items:center;gap:8px;margin-bottom:4px;}
.dash-fbar{flex:1;height:8px;background:var(--bg-4);border-radius:4px;overflow:hidden;}
.dash-fbar-fill{height:100%;background:var(--accent);border-radius:4px;}
.dash-fbar-size{font-size:10px;color:var(--text-3);width:60px;text-align:right;}
.dg{background:var(--bg-2);border-radius:8px;padding:10px 12px;margin-bottom:6px;border:1px solid var(--border);}
.dg-hd{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;}
.dg-nm{font-size:11px;font-weight:600;}
.dg-sub{font-size:16px;font-weight:700;color:var(--accent);}
.dg-bar{display:grid;grid-template-columns:68px 1fr 28px;align-items:center;gap:6px;margin-bottom:3px;}
.dg-lbl{font-size:11px;color:var(--text-2);text-align:right;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.dg-track{height:14px;background:var(--bg-4);border-radius:3px;overflow:hidden;}
.dg-fill{height:100%;border-radius:3px;transition:width 0.4s;}
.dg-cnt{font-size:11px;font-weight:700;text-align:right;}
.dg-core .dg-fill{background:linear-gradient(90deg,var(--layer-2),color-mix(in srgb,var(--layer-2) 60%,#fff));}
.dg-ai .dg-fill{background:linear-gradient(90deg,var(--accent-2),color-mix(in srgb,var(--accent-2) 60%,#fff));}
.dg-infra .dg-fill{background:linear-gradient(90deg,var(--layer-5),color-mix(in srgb,var(--layer-5) 60%,#fff));}
.dg-qa .dg-fill{background:linear-gradient(90deg,var(--warn),#fbbf24);}
.dg-total{display:flex;justify-content:space-between;align-items:center;margin-top:8px;padding-top:6px;border-top:1px solid var(--border);font-size:11px;color:var(--text-2);}
.dg-total strong{font-size:16px;color:var(--text);}
.dash-total{font-size:11px;color:var(--text-3);margin-top:6px;}
/* Compat check */
.compat-ok{background:var(--bg-2);border:1px solid var(--success);border-radius:var(--radius);padding:10px 12px;font-size:12px;color:var(--success);}
.compat-summary{display:flex;gap:12px;margin-bottom:8px;font-size:12px;font-weight:600;}
.compat-s-ok{color:var(--success);}.compat-s-warn{color:var(--warn);}.compat-s-err{color:var(--danger);}.compat-s-info{color:var(--accent);}
.compat-error,.compat-warn,.compat-info{display:flex;align-items:center;gap:8px;padding:8px 12px;border-radius:var(--radius);font-size:11px;margin-bottom:4px;flex-wrap:wrap;}
.compat-error{background:color-mix(in srgb,var(--danger) 9%,transparent);border:1px solid color-mix(in srgb,var(--danger) 25%,transparent);}
.compat-warn{background:color-mix(in srgb,var(--warn) 9%,transparent);border:1px solid color-mix(in srgb,var(--warn) 25%,transparent);}
.compat-info{background:color-mix(in srgb,var(--accent) 9%,transparent);border:1px solid color-mix(in srgb,var(--accent) 25%,transparent);}
.compat-icon{font-size:14px;flex-shrink:0;}
.compat-pair{font-weight:700;font-size:10px;background:var(--bg-3);padding:2px 6px;border-radius:3px;white-space:nowrap;}
.compat-msg{flex:1;min-width:120px;line-height:1.5;}
.compat-fix{flex-shrink:0;font-size:10px!important;padding:2px 8px!important;}
.compat-jump{flex-shrink:0;font-size:10px!important;padding:2px 8px!important;border:1px solid var(--border)!important;}
.compat-ack{flex-shrink:0;font-size:10px!important;padding:2px 8px!important;border:1px solid var(--border)!important;opacity:.7;transition:opacity .2s;}.compat-ack:hover{opacity:1;}
.compat-acked{opacity:0.35!important;pointer-events:none;text-decoration:line-through;transition:opacity .3s;}
/* compat badge (案α) */
.compat-badge-row{display:flex;align-items:center;gap:6px;padding:5px 8px;border-radius:6px;background:var(--bg-3);border:1px solid var(--border);font-size:11px;margin-bottom:4px;}
.compat-badge-ok{font-size:11px;color:var(--success);padding:5px 8px;border-radius:6px;background:color-mix(in srgb,var(--success) 8%,transparent);border:1px solid color-mix(in srgb,var(--success) 20%,transparent);margin-bottom:4px;}
.cb-error{color:var(--danger);font-weight:700;}.cb-warn{color:var(--warn);font-weight:700;}.cb-info{color:var(--accent);font-weight:700;}.cb-label{color:var(--text-3);margin-left:2px;}
/* compat summary card (案γ) */
.compat-summary-card{border:1px solid var(--border);border-radius:var(--radius);padding:10px 12px;background:var(--bg-2);margin:4px 0;}
.compat-summary-title{font-size:12px;font-weight:700;color:var(--text-2);margin-bottom:8px;}
.compat-sum-item{margin-bottom:4px;border-radius:6px;}
.compat-summary-actions{margin-top:8px;display:flex;justify-content:flex-end;}
.compat-summary-card.dismissed{opacity:0.35;pointer-events:none;transition:opacity .3s;}
/* Why-Card (③-A) */
.compat-why{width:100%;margin-top:4px;font-size:11px;}
.compat-why-toggle{cursor:pointer;color:var(--text-3);font-size:10px;list-style:none;padding:2px 0;user-select:none;}
.compat-why-toggle:hover{color:var(--accent);}
.compat-why-body{margin-top:4px;padding:6px 10px;background:var(--bg-3);border-left:2px solid var(--accent-soft);border-radius:4px;line-height:1.6;color:var(--text-2);}
/* Export Warning Banner (⑤-C) */
.export-warn-banner{display:flex;align-items:center;gap:12px;padding:10px 14px;margin-bottom:12px;background:color-mix(in srgb,var(--warn) 10%,transparent);border:1px solid color-mix(in srgb,var(--warn) 30%,transparent);border-radius:var(--radius);font-size:12px;color:var(--warn-text);flex-wrap:wrap;}
/* Synergy Score */
.synergy-card{background:var(--bg-3);border:1px solid var(--border);border-radius:var(--radius);padding:14px;margin-bottom:12px;}
.synergy-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;}
.synergy-label{font-size:13px;font-weight:600;}
.synergy-score{font-size:28px;font-weight:700;padding:6px 14px;border-radius:8px;}
.synergy-bar{height:10px;background:var(--bg-4);border-radius:5px;overflow:hidden;margin-bottom:12px;}
.synergy-bar-fill{height:100%;border-radius:5px;transition:width .6s;}
.synergy-dims{display:flex;flex-direction:column;gap:6px;margin-bottom:8px;}
.synergy-dim{display:grid;grid-template-columns:110px 1fr 32px;align-items:center;gap:8px;font-size:11px;}
.synergy-dim-lbl{color:var(--text-2);text-align:right;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.synergy-dim-bar{height:12px;background:var(--bg-4);border-radius:3px;overflow:hidden;}
.synergy-dim-fill{height:100%;border-radius:3px;transition:width .4s;}
.synergy-dim-val{font-weight:700;text-align:right;}
.synergy-domain{font-size:11px;color:var(--text-3);padding-top:8px;border-top:1px solid var(--border);}
.synergy-domain strong{color:var(--accent);}
/* File Dependency Tree */
.fdep-group{background:var(--bg-3);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:6px;overflow:hidden;}
.fdep-header{padding:8px 12px;cursor:pointer;display:flex;align-items:center;gap:8px;font-size:12px;font-weight:600;user-select:none;transition:background .15s;}
.fdep-header:hover{background:var(--bg-4);}
.fdep-icon{font-size:10px;width:12px;transition:transform .2s;}
.fdep-title{flex:1;}
.fdep-count{font-size:10px;color:var(--text-3);background:var(--bg-4);padding:2px 8px;border-radius:10px;}
.fdep-body{max-height:0;overflow:hidden;transition:max-height .3s ease;}
.fdep-body.fdep-open{max-height:500px;padding:8px 12px;}
.fdep-item{font-size:11px;padding:3px 0;display:flex;align-items:center;gap:4px;}
.fdep-ind-1{padding-left:16px;}
.fdep-ind-2{padding-left:32px;}
.fdep-exists a{color:var(--success);text-decoration:none;}
.fdep-exists a:hover{text-decoration:underline;}
.fdep-missing span{color:var(--text-3);opacity:0.5;}
/* Context-Aware Guide */
.guide-domain-steps{display:flex;flex-direction:column;gap:8px;margin:12px 0;background:var(--bg-3);padding:12px;border-radius:8px;border:1px solid var(--border);}
.guide-step-mini{display:flex;align-items:center;gap:10px;font-size:12px;color:var(--text);}
.guide-step-num-mini{width:24px;height:24px;min-width:24px;background:var(--accent);color:#fff;border-radius:6px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:11px;}
.guide-ai-recipe{background:var(--bg-3);padding:12px;border-radius:8px;border:1px solid var(--border);margin:12px 0;}
.guide-ai-recipe h4{font-size:13px;margin-bottom:8px;color:var(--accent);}
.guide-recipe-step{font-size:12px;padding:6px 0;color:var(--text-2);border-bottom:1px solid var(--border);}
.guide-recipe-step:last-child{border-bottom:none;}
.guide-adr-intro{font-size:12px;color:var(--text-3);margin-bottom:8px;}
.guide-adrs{display:flex;flex-direction:column;gap:8px;margin:8px 0;}
.guide-adr{display:flex;gap:12px;background:var(--bg-3);padding:10px 12px;border-radius:8px;border:1px solid var(--border);}
.guide-adr-icon{font-size:20px;min-width:28px;}
.guide-adr strong{font-size:12px;display:block;margin-bottom:2px;color:var(--text);}
.guide-adr p{font-size:11px;color:var(--text-3);margin:0;}
/* Backup banner */
.dash-backup{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:8px 12px;border-radius:var(--radius);font-size:11px;margin-bottom:8px;flex-wrap:wrap;}
.dash-backup-red{background:color-mix(in srgb,var(--danger) 9%,transparent);border:1px solid color-mix(in srgb,var(--danger) 25%,transparent);color:var(--danger);}
.dash-backup-yellow{background:color-mix(in srgb,var(--warn) 9%,transparent);border:1px solid color-mix(in srgb,var(--warn) 25%,transparent);color:var(--warn);}
.dash-guide{background:var(--accent-soft);border:1px solid color-mix(in srgb,var(--accent) 25%,transparent);color:var(--accent);}
.guide-action-p{margin-top:16px;}
.cx-mini{margin-left:6px;font-size:10px;font-weight:700;opacity:0.9;}
.dash-advanced{margin:12px 0;border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;}
.dash-adv-toggle{padding:8px 12px;background:var(--bg-3);cursor:pointer;font-size:12px;font-weight:600;color:var(--text-2);list-style:none;display:block;}
.dash-adv-toggle::-webkit-details-marker{display:none;}
.dash-adv-toggle::before{content:'▶ ';font-size:10px;}
details[open]>.dash-adv-toggle::before{content:'▼ ';}
.dash-advanced>summary~*{padding:0 4px;}
.dash-info{font-size:12px;}
.dash-center{margin-top:16px;text-align:center;}
.dash-center .btn{font-size:11px;}
.fsize-chart{display:flex;flex-direction:column;gap:6px;}
.fsize-row{display:flex;align-items:center;gap:8px;font-size:11px;}
.fsize-lbl{min-width:90px;color:var(--text-3);white-space:nowrap;font-weight:600;}
.fsize-bar-wrap{flex:1;height:10px;background:var(--bg-3);border-radius:5px;overflow:hidden;}
.fsize-bar{height:100%;border-radius:5px;transition:width .4s;}
.fsize-val{min-width:50px;text-align:right;color:var(--text-3);font-size:10px;}
.dash-back{margin-top:8px;text-align:center;}
.dash-back .btn{font-size:11px;}
.dash-tfcount{font-size:11px;color:var(--text-3);align-self:center;}
.dash-tbl-wrap{max-height:60vh;overflow-y:auto;}
.dash-price{font-size:9px;color:var(--text-3);}
.dash-empty{color:var(--text-3);text-align:center;margin-top:40px;}
/* Toast System (Enhanced with stacking, types, undo) */
.toast-msg{position:fixed;bottom:20px;left:50%;transform:translateX(-50%) translateY(0);background:var(--bg-3);color:var(--text);padding:10px 16px;border-radius:8px;font-size:12px;z-index:999;border:1px solid var(--border);box-shadow:0 4px 16px rgba(0,0,0,0.2);display:flex;align-items:center;gap:12px;min-width:280px;max-width:480px;animation:toastIn .2s ease-out;transition:all .2s;}
.toast-msg.toast-success{border-color:var(--success);background:color-mix(in srgb,var(--success) 10%,var(--bg-3));}
.toast-msg.toast-error{border-color:var(--danger);background:color-mix(in srgb,var(--danger) 10%,var(--bg-3));}
.toast-msg.toast-info{border-color:var(--accent);background:color-mix(in srgb,var(--accent) 8%,var(--bg-3));}
.toast-text{flex:1;}
.toast-action{padding:6px 12px;border:none;border-radius:6px;font-size:11px;font-weight:600;cursor:pointer;background:var(--accent);color:white;transition:all .15s;white-space:nowrap;}
.toast-action:hover{background:color-mix(in srgb,var(--accent) 80%,black);transform:translateY(-1px);}
.toast-exit{animation:toastOut .2s ease-out;opacity:0;transform:translateX(-50%) translateY(20px);}
@keyframes toastIn{from{opacity:0;transform:translateX(-50%) translateY(20px);}to{opacity:1;transform:translateX(-50%) translateY(0);}}
@keyframes toastOut{from{opacity:1;transform:translateX(-50%) translateY(0);}to{opacity:0;transform:translateX(-50%) translateY(20px);}}

/* Command Palette (Ctrl+P) */
.cmdpalette-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);z-index:1000;display:flex;align-items:flex-start;justify-content:center;padding-top:15vh;animation:fadeIn .15s ease-out;}
.cmdpalette-box{background:var(--bg-2);border:1px solid var(--border);border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,0.4);width:90%;max-width:600px;max-height:60vh;display:flex;flex-direction:column;animation:cmdSlideDown .2s ease-out;}
@keyframes cmdSlideDown{from{opacity:0;transform:translateY(-20px);}to{opacity:1;transform:translateY(0);}}
.cmdpalette-input-wrap{display:flex;align-items:center;gap:12px;padding:16px;border-bottom:1px solid var(--border);}
.cmdpalette-icon{font-size:20px;}
.cmdpalette-input{flex:1;background:var(--bg-1);border:none;border-radius:8px;padding:10px 12px;font-size:14px;color:var(--text);outline:none;}
.cmdpalette-input:focus{box-shadow:0 0 0 2px var(--accent);}
.cmdpalette-results{overflow-y:auto;max-height:50vh;padding:8px;}
.cmdpalette-item{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:8px;cursor:pointer;transition:all .1s;margin-bottom:4px;}
.cmdpalette-item:hover{background:var(--bg-3);}
.cmdpalette-item-selected{background:var(--accent-soft);border-left:3px solid var(--accent);}
.cmdpalette-item-icon{font-size:16px;width:24px;text-align:center;}
.cmdpalette-item-label{flex:1;font-size:13px;color:var(--text);}
.cmdpalette-item-cat{font-size:10px;text-transform:uppercase;letter-spacing:0.5px;color:var(--text-3);background:var(--bg-1);padding:2px 6px;border-radius:4px;}
.cmdpalette-item-kb{font-size:10px;color:var(--text-3);background:var(--bg-1);padding:4px 6px;border-radius:4px;font-family:monospace;border:1px solid var(--border);}
.cmdpalette-empty{text-align:center;padding:40px 20px;color:var(--text-3);font-size:13px;}

.prev-footer{padding:12px 0;text-align:center;font-size:11px;color:var(--text-3);border-top:1px solid var(--border);margin-top:12px;}
.dash-total-mt{margin-top:8px;}
.launch-output{display:none;}
.tour-title{font-size:14px;margin-bottom:6px;}
.tour-desc{font-size:12px;color:var(--text-2);line-height:1.6;}
.tour-acts{display:flex;gap:6px;justify-content:flex-end;margin-top:8px;}
.gen-spinner{padding:16px;text-align:center;display:flex;flex-direction:column;align-items:center;gap:10px;}
.gen-spinner-icon{display:inline-block;font-size:24px;}
.gen-prog-wrap{width:200px;}
.gen-prog-bar{height:6px;background:var(--bg-3);border-radius:3px;overflow:hidden;}
.gen-prog-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--success));border-radius:3px;transition:width .3s;width:0%;}
.gen-prog-label{font-size:11px;color:var(--text-2);margin-top:6px;font-weight:600;}

/* Pillar Grid Loading (HCD: ⑤感情体験 ③認知負荷) */
.gen-pillar-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;width:100%;max-width:500px;margin:16px 0;}
.gen-pillar-card{position:relative;background:var(--bg-2);border:1px solid var(--border);border-radius:8px;padding:12px 8px;text-align:center;transition:all .3s;}
.gen-pillar-card[data-status="pending"]{opacity:0.4;}
.gen-pillar-card[data-status="processing"]{border-color:var(--accent);background:color-mix(in srgb,var(--accent) 10%,var(--bg-2));animation:pillarPulse 1s infinite;}
.gen-pillar-card[data-status="completed"]{border-color:var(--success);background:color-mix(in srgb,var(--success) 10%,var(--bg-2));opacity:1;}
.gen-pillar-icon{font-size:20px;margin-bottom:4px;}
.gen-pillar-name{font-size:9px;color:var(--text-2);font-weight:600;line-height:1.2;}
.gen-pillar-check{position:absolute;top:4px;right:4px;font-size:12px;color:var(--success);opacity:0;transition:opacity .2s;}
.gen-pillar-card[data-status="completed"] .gen-pillar-check{opacity:1;}
@keyframes pillarPulse{0%,100%{transform:scale(1);}50%{transform:scale(1.05);}}

.complexity-label{font-weight:600;}
.complexity-sub{font-size:13px;margin-top:2px;}
.btn-start{padding:12px 40px;font-size:14px;}
.prev-placeholder{color:var(--text-3);font-size:13px;text-align:center;margin-top:40px;}
.btn-diff{color:var(--warn);}
.tree-item{cursor:pointer;}
.tree-indent{padding-left:16px;}
.tree-disabled{opacity:0.4;}
.tree-edited{float:right;font-size:9px;color:var(--warn);margin-right:4px;}
.tree-gen{float:right;font-size:10px;color:var(--success);}
.launch-ok{color:var(--success);}
.launch-warn{color:var(--warn);}
.road-pct-sub{font-size:12px;font-weight:400;color:var(--text-3);}
.road-layer-pct{font-size:10px;font-weight:400;opacity:0.7;}
.road-actions{margin-top:12px;display:flex;gap:8px;justify-content:center;}
.road-actions .btn{font-size:11px;}

/* ═══ EXPLORER ═══ */
.exp-compare{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
.exp-col{background:var(--bg-3);border:1px solid var(--border);border-radius:var(--radius);padding:16px;}
.exp-col h3{font-size:14px;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid var(--border);}
.exp-row{display:flex;justify-content:space-between;padding:4px 0;font-size:12px;}
.exp-row .label{color:var(--text-3);}.exp-row .val{font-weight:600;}
.exp-verdict{margin-top:12px;padding:12px;background:var(--accent-soft);border:1px solid rgba(59,130,246,0.2);border-radius:var(--radius);}
.exp-verdict h4{font-size:12px;color:var(--accent);margin-bottom:4px;}.exp-verdict p{font-size:11px;color:var(--text-2);}
.exp-select{display:flex;gap:8px;margin-bottom:12px;}
.exp-select select{flex:1;padding:8px 12px;border:1px solid var(--border);border-radius:7px;background:var(--bg-3);color:var(--text);font-size:12px;font-family:var(--sans);}

/* ═══ ROADMAP ═══ */
.road-progress{background:var(--bg-3);border:1px solid var(--border);border-radius:var(--radius);padding:14px;margin-bottom:16px;}
.road-progress h4{font-size:12px;margin-bottom:8px;}
.road-progress-bar{height:12px;background:var(--bg-4);border-radius:6px;overflow:hidden;}
.road-progress-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--success));border-radius:6px;transition:width .6s;}
.road-pct{font-size:20px;font-weight:700;color:var(--accent);margin-top:4px;}
.road-layer{margin-bottom:20px;}
.road-layer h3{font-size:13px;color:var(--accent);margin-bottom:8px;padding:6px 10px;background:var(--accent-soft);border-radius:6px;display:inline-block;}
.road-task{display:flex;align-items:center;gap:8px;padding:6px 0;font-size:12px;cursor:pointer;transition:background .1s;border-radius:4px;padding:4px 8px;}
.road-task:hover{background:var(--bg-4);}
.road-task input[type="checkbox"]{accent-color:var(--accent);width:16px;height:16px;cursor:pointer;}
.road-task.checked{color:var(--text-3);text-decoration:line-through;}
.road-week-badge{font-size:9px;padding:2px 6px;background:var(--bg-4);border-radius:8px;color:var(--text-3);margin-left:auto;flex-shrink:0;}
.road-hrs-badge{font-size:9px;padding:2px 6px;background:var(--accent-soft);border-radius:8px;color:var(--accent);flex-shrink:0;}
.road-time{font-size:11px;color:var(--text-3);margin-top:6px;}
.road-time strong{color:var(--text);}
.road-milestone{margin-top:8px;padding:6px 12px;background:linear-gradient(90deg,var(--accent-soft),transparent);border-radius:6px;font-size:12px;font-weight:600;color:var(--accent);animation:roadFadeIn .5s;}
@keyframes roadFadeIn{from{opacity:0;transform:translateY(-4px);}to{opacity:1;transform:translateY(0);}}
.road-layer-head{cursor:pointer;user-select:none;display:flex!important;align-items:center;gap:4px;width:100%;}
.road-collapse-icon{font-size:10px;opacity:0.6;width:12px;text-align:center;}
.road-layer-hrs{margin-left:auto;font-size:9px;font-weight:400;opacity:0.6;}
.road-items{transition:max-height .3s ease,opacity .2s;overflow:hidden;}
.road-collapsed{max-height:0!important;opacity:0;margin:0;padding:0;}
.road-locked{opacity:0.6;}
.road-lock-msg{font-size:10px;color:var(--text-3);padding:4px 12px;margin-bottom:8px;font-style:italic;}
.road-task-locked{pointer-events:none;opacity:0.5;}
.road-task-locked input{pointer-events:none;}
.road-res-btn{font-size:12px;text-decoration:none;flex-shrink:0;opacity:0.5;transition:opacity .15s;padding:0 2px;}
.road-res-btn:hover{opacity:1;}
.road-badge-anim{animation:roadBadge .6s ease;display:inline-block;margin-left:4px;}
@keyframes roadBadge{0%{transform:scale(0);opacity:0;}50%{transform:scale(1.4);}100%{transform:scale(1);opacity:1;}}

.hero-anim{position:relative;overflow:hidden;padding:20px;border-radius:var(--radius-lg);}
.hero-anim::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:conic-gradient(from 0deg,transparent,var(--accent-soft),transparent);animation:spin 8s linear infinite;z-index:0;}
.hero-content{position:relative;z-index:1;}
.stat-row{display:flex;gap:14px;justify-content:center;flex-wrap:wrap;}
.stat-item{text-align:center;}.stat-item .num{font-size:28px;font-weight:700;color:var(--accent);}.stat-item .lbl{font-size:11px;color:var(--text-3);}
.version-badge{display:inline-block;padding:4px 12px;border-radius:20px;font-size:11px;font-weight:600;background:linear-gradient(135deg,var(--accent),var(--accent-2));color:#fff;margin-bottom:12px;}
.kb-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:250;display:none;align-items:center;justify-content:center;}
.kb-overlay.show{display:flex;}
.kb-modal{background:var(--bg-2);border:1px solid var(--border);border-radius:var(--radius-lg);padding:24px;max-width:400px;width:90%;}
.kb-modal h3{font-size:16px;margin-bottom:16px;}
.kb-row{display:flex;justify-content:space-between;padding:6px 0;font-size:12px;color:var(--text-2);border-bottom:1px solid var(--border);}
.kb-key{font-family:var(--mono);padding:2px 8px;background:var(--bg-3);border:1px solid var(--border);border-radius:4px;font-size:11px;}
/* ═══ V7 UX FEATURES ═══ */
.skill-sel{display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap;justify-content:center;}
.skcard{width:185px;padding:18px 14px;border-radius:var(--radius-lg);border:2px solid var(--border);background:var(--bg-2);cursor:pointer;transition:all 0.2s;text-align:left;}
.skcard:hover{border-color:var(--border-light);background:var(--bg-3);}
.skcard.on{border-color:var(--accent);background:var(--accent-soft);}
.skcard .em{font-size:26px;margin-bottom:8px;}
.skcard h3,.skcard h4{font-size:13px;font-weight:600;margin-bottom:3px;}
.skcard p{font-size:11px;color:var(--text-3);line-height:1.5;}
.skill-fine{margin:8px 0 4px;padding:4px 8px;}
.skill-fine-ticks{display:flex;justify-content:space-between;font-size:14px;margin-bottom:2px;padding:0 2px;}
.skill-fine input[type="range"]{width:100%;accent-color:var(--accent);cursor:pointer;}
.skill-fine-label{text-align:center;font-size:13px;color:var(--text);margin-top:4px;font-weight:600;}
.szl{font-size:11px;color:var(--text-3);margin-bottom:8px;text-align:center;font-weight:600;text-transform:uppercase;letter-spacing:0.5px;}
.chip{padding:6px 12px;border-radius:18px;font-size:12px;border:1.5px solid var(--chip-border,var(--border));background:var(--chip-bg,var(--bg-3));cursor:pointer;transition:all 0.12s;color:var(--text-2);user-select:none;display:flex;align-items:center;gap:5px;}
.chip:hover{border-color:var(--accent);color:var(--text);}
.chip.on{border-color:var(--accent);background:var(--accent-soft);color:var(--accent);font-weight:500;}
.chip .ck{width:13px;height:13px;border-radius:3px;border:1.5px solid var(--text-3);display:flex;align-items:center;justify-content:center;font-size:9px;transition:all 0.12s;}
.chip.on .ck{border-color:var(--accent);background:var(--accent);color:#fff;}
.czone{padding:10px 20px;}
.czlabel{font-size:11px;color:var(--text-3);margin-bottom:8px;font-weight:500;}
.cgrid{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:8px;max-height:32vh;overflow-y:auto;}
.cfoot{padding:6px 20px 12px;display:flex;gap:6px;align-items:center;}
.chip-count-badge{font-size:11px;color:var(--text-3);white-space:nowrap;flex-shrink:0;}
.cfoot input.cadd{flex:1;padding:8px 14px;border-radius:20px;border:1.5px solid var(--border);background:var(--bg-3);color:var(--text);font-size:12px;outline:none;}
.cfoot input.cadd:focus{border-color:var(--accent);}
.ocards{padding:10px 20px;display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:8px;}
.ocard{padding:14px;border-radius:var(--radius);border:1.5px solid var(--border);background:var(--bg-3);cursor:pointer;transition:all 0.15s;}
.ocard:hover{border-color:var(--accent);background:var(--accent-soft);}
.ocard h5{font-size:13px;font-weight:600;margin-bottom:3px;}
.ocard p{font-size:11px;color:var(--text-3);line-height:1.4;}
.ocard-rec-badge{display:inline-block;margin-left:6px;padding:1px 6px;font-size:9px;font-weight:600;background:color-mix(in srgb,var(--warn) 15%,transparent);color:var(--warn);border:1px solid color-mix(in srgb,var(--warn) 30%,transparent);border-radius:10px;vertical-align:middle;}
.m-edit{position:absolute;top:4px;right:4px;background:none;border:none;color:var(--text-3);cursor:pointer;font-size:13px;padding:2px 5px;border-radius:4px;opacity:0;transition:0.15s;}
.msg:hover .m-edit{opacity:1;}
.m-edit:hover{color:var(--warn);background:var(--warn-soft);}
.q-help{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border-radius:50%;background:var(--accent-soft);color:var(--accent);font-size:10px;font-weight:700;cursor:pointer;margin-left:6px;transition:0.15s;}
.q-help:hover{background:var(--accent);color:#fff;}
.voice-btn{background:none;border:1px solid var(--border);border-radius:50%;width:32px;height:32px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:14px;color:var(--text-3);transition:0.15s;flex-shrink:0;}
.voice-btn:hover{border-color:var(--accent);color:var(--accent);}
.voice-btn.recording{border-color:var(--danger);color:var(--danger);animation:pulse 1s infinite;}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.4}}
.skip-btn{background:none;border:none;color:var(--text-3);font-size:11px;cursor:pointer;padding:4px 10px;border-radius:12px;transition:0.15s;}
.skip-btn:hover{background:var(--bg-3);color:var(--text-2);}
/* DnD Keyboard Accessibility (HCD: A アクセシビリティ ④身体負荷) */
.dnd-hint{font-size:11px;color:var(--text-3);margin-bottom:8px;font-style:italic;}
.dnd-list{list-style:none;padding:0;margin:0 0 8px;max-height:40vh;overflow-y:auto;}
.dnd-item{display:flex;align-items:center;gap:8px;padding:8px 12px;margin:3px 0;border-radius:7px;border:1.5px solid var(--border);background:var(--bg-3);cursor:grab;transition:all 0.12s;user-select:none;font-size:12px;color:var(--text);}
.dnd-item:active{cursor:grabbing;background:var(--bg-4);border-color:var(--accent);box-shadow:0 4px 12px rgba(0,0,0,0.3);}
.dnd-item:focus{outline:2px solid var(--accent);outline-offset:2px;border-color:var(--accent);}
.dnd-grip{color:var(--text-3);font-size:14px;cursor:grab;}
.dnd-label{flex:1;}
.dnd-priority{font-size:10px;font-weight:600;padding:2px 8px;border-radius:10px;}
.dnd-priority.p0{background:rgba(239,68,68,0.15);color:var(--danger);}
.dnd-priority.p1{background:rgba(234,179,8,0.15);color:var(--warn);}
.dnd-priority.p2{background:rgba(100,116,139,0.15);color:var(--text-3);}
.drag-over{border-color:var(--accent);background:var(--accent-soft);}
.dnd-del{flex-shrink:0;background:none;border:1px solid var(--border);color:var(--text-2);cursor:pointer;font-size:13px;line-height:1;padding:2px 6px;border-radius:4px;transition:all 0.12s;}.dnd-del:hover,.dnd-del:focus{color:var(--danger);border-color:var(--danger);background:rgba(248,113,113,0.1);outline:none;}
.confirm-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:350;display:none;align-items:center;justify-content:center;animation:fadeIn 0.2s;}
.confirm-modal{background:var(--bg-2);border:1px solid var(--border);border-radius:var(--radius-lg);padding:24px;max-width:420px;width:90%;}
.confirm-modal h4{font-size:14px;font-weight:600;margin-bottom:12px;}
.confirm-modal .cm-val{background:var(--bg-4);padding:10px 14px;border-radius:var(--radius);font-size:12px;color:var(--text);margin-bottom:16px;max-height:120px;overflow-y:auto;line-height:1.6;}
.confirm-modal .cm-acts{display:flex;gap:8px;justify-content:flex-end;}
.complexity-card{margin:12px 0;padding:16px;border-radius:var(--radius-lg);background:var(--bg-3);border:1px solid var(--border);animation:fadeIn 0.3s;}
.complexity-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;}
.complexity-score{font-size:32px;font-weight:700;}
.complexity-score.low{color:var(--success);}
.complexity-score.mid{color:var(--warn);}
.complexity-score.high{color:var(--danger);}
.complexity-bar{height:6px;border-radius:3px;background:var(--bg-4);margin-bottom:12px;overflow:hidden;}
.complexity-fill{height:100%;border-radius:3px;transition:width 0.6s ease;}
.complexity-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;}
.complexity-item{display:flex;justify-content:space-between;font-size:12px;padding:4px 0;border-bottom:1px solid var(--border);}
.pm-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:350;display:none;align-items:center;justify-content:center;animation:fadeIn 0.2s;}
.pm-modal{background:var(--bg-2);border:1px solid var(--border);border-radius:var(--radius-lg);padding:24px;max-width:500px;width:90%;max-height:80vh;overflow-y:auto;}
.pm-modal h3{font-size:16px;font-weight:700;margin-bottom:16px;}
.pm-item{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-radius:var(--radius);border:1px solid var(--border);margin-bottom:6px;cursor:pointer;transition:0.15s;}
.pm-item:hover{border-color:var(--accent);background:var(--accent-soft);}
.pm-item.current{border-color:var(--accent);background:var(--accent-soft);}
.pm-item-name{font-size:13px;font-weight:500;}
.pm-item-meta{font-size:10px;color:var(--text-3);}
.pm-item-acts{display:flex;gap:4px;}
.pm-item-acts button{background:none;border:none;cursor:pointer;font-size:12px;padding:2px 4px;}
.pm-storage{margin:12px 0 4px;font-size:11px;color:var(--text-3);}
.pm-storage-label{margin-bottom:4px;}
.pm-storage-bar{height:6px;background:var(--bg-4);border-radius:3px;overflow:hidden;}
.pm-storage-fill{height:100%;border-radius:3px;transition:width 0.3s;}
.pm-actions{margin-top:12px;display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end;}
.toc-panel{display:none;padding:6px 8px;overflow-x:auto;white-space:nowrap;border-bottom:1px solid var(--border);background:var(--bg-2);}
.toc-item{display:inline-flex;align-items:center;gap:4px;padding:3px 8px;border-radius:4px;cursor:pointer;font-size:10px;color:var(--text-3);transition:0.15s;margin-right:2px;}
.toc-item:hover{background:var(--accent-soft);color:var(--accent);}
.toc-item.done{color:var(--success);}
.toc-item.active{color:var(--accent);font-weight:600;}
.toc-dot{width:5px;height:5px;border-radius:50%;flex-shrink:0;background:var(--border-light);}
.toc-item.done .toc-dot{background:var(--success);}
.toc-item.active .toc-dot{background:var(--accent);}
.edit-banner{padding:8px 20px;background:var(--warn-soft,rgba(234,179,8,0.1));color:var(--warn);font-size:11px;font-weight:600;display:flex;align-items:center;justify-content:space-between;}
.skipped-banner{padding:8px 20px;background:var(--accent-soft);color:var(--accent);font-size:11px;font-weight:600;}
.tour-container{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);z-index:400;max-width:440px;width:92%;}
.tour-card{background:var(--bg-2);border:2px solid var(--accent);border-radius:var(--radius-lg);padding:20px;box-shadow:0 8px 30px rgba(0,0,0,0.4);}
.tour-dots{display:flex;gap:6px;justify-content:center;margin:10px 0;}
.tour-dot{width:8px;height:8px;border-radius:50%;background:var(--border);}
.tour-dot.on{background:var(--accent);}
/* ═══ LIGHT THEME ═══ */
[data-theme="light"] .skcard{background:var(--bg-2);border-color:var(--border);}
[data-theme="light"] .m-bot{background:var(--bg-3);border-color:var(--border);}
[data-theme="light"] .m-usr{background:rgba(59,130,246,0.08);border-color:rgba(59,130,246,0.2);}
[data-theme="light"] .m-tip{color:var(--text-3);}
[data-theme="light"] .skcard:hover{background:var(--bg-3);border-color:var(--text-3);}
[data-theme="light"] .skcard.on{background:rgba(59,130,246,0.06);border-color:var(--accent);}
[data-theme="light"] .complexity-card{background:var(--bg-3);border-color:var(--border);}
[data-theme="light"] .dnd-item{background:var(--bg-2);border-color:var(--border);}
[data-theme="light"] .confirm-modal,[data-theme="light"] .pm-modal,[data-theme="light"] .tour-card{background:var(--bg-2);border-color:var(--border);}
[data-theme="light"] .voice-btn{border-color:var(--border);color:var(--text-3);}
[data-theme="light"] .pm-item{border-color:var(--border);}
[data-theme="light"] .pm-item:hover{background:rgba(59,130,246,0.04);}
@keyframes fadeIn{from{opacity:0;transform:translateY(5px)}to{opacity:1;transform:translateY(0)}}
.msg{margin-bottom:4px;animation:fadeIn 0.25s ease;}
.m-bot{background:var(--bg-3);padding:8px 12px;border-radius:3px var(--radius) var(--radius) var(--radius);border-left:3px solid var(--accent);}
.m-usr{background:var(--surface,var(--bg-4));padding:8px 12px;border-radius:var(--radius) 3px var(--radius) var(--radius);margin-left:32px;border-right:3px solid var(--accent-2,#8b5cf6);position:relative;}
.m-tip{background:var(--warn-soft,rgba(234,179,8,0.1));padding:8px 12px;border-radius:var(--radius);border-left:3px solid var(--warn);font-size:12px;color:var(--warn);}
.m-lbl{font-size:9px;font-weight:600;text-transform:uppercase;letter-spacing:0.8px;margin-bottom:5px;color:var(--text-3);display:flex;align-items:center;gap:4px;}
.m-body{font-size:12px;line-height:1.6;}
.phase-fold{margin:4px 0;border-radius:var(--radius);border:1px solid var(--border);background:var(--bg-2);}
.phase-fold-sum{padding:6px 12px;font-size:11px;font-weight:600;color:var(--text-3);cursor:pointer;list-style:none;display:flex;align-items:center;gap:6px;}
.phase-fold-sum::before{content:'▶';font-size:9px;transition:transform .2s;}
.phase-fold[open] .phase-fold-sum::before{transform:rotate(90deg);}
.phase-fold-sum::-webkit-details-marker{display:none;}

.pd-title{font-size:10px;font-weight:700;color:var(--text-3);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;}
.pd-phase{display:flex;align-items:center;gap:8px;padding:6px 8px;border-radius:8px;margin-bottom:4px;cursor:pointer;transition:all 0.15s;font-size:12px;font-weight:600;color:var(--text-2);}
.pd-phase:hover{background:var(--accent-soft);}
.pd-phase.active{background:var(--accent-soft);color:var(--accent);}
.pd-phase.done{color:var(--success);}
.pd-dot{width:8px;height:8px;border-radius:50%;background:var(--border-light);flex-shrink:0;transition:0.2s;}
.pd-phase.active .pd-dot{background:var(--accent);box-shadow:0 0 6px var(--accent);}
.pd-phase.done .pd-dot{background:var(--success);}
.pd-progress{margin-top:8px;padding-top:8px;border-top:1px solid var(--border);font-size:10px;color:var(--text-3);display:flex;align-items:center;gap:6px;}
.pd-bar{flex:1;height:4px;background:var(--bg-3);border-radius:2px;overflow:hidden;}
.pd-bar-fill{height:100%;background:var(--accent);border-radius:2px;transition:width 0.3s;}
.pd-gen{margin-top:10px;width:100%;font-size:11px;padding:6px 0;}
.pd-qlist{margin:0;padding:0 0 0 16px;list-style:none;}
.pd-q{padding:3px 4px;font-size:10px;color:var(--text-3);cursor:pointer;border-radius:4px;transition:all .15s;display:flex;align-items:center;gap:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.pd-q:hover{background:var(--bg-3);color:var(--text);}
.pd-q.current{color:var(--accent);font-weight:600;}
.pd-q .pd-qmark{width:6px;height:6px;border-radius:50%;flex-shrink:0;}
.pd-q.answered .pd-qmark{background:var(--success);}
.pd-q:not(.answered) .pd-qmark{background:var(--border-light);}
.pd-q.current .pd-qmark{background:var(--accent);box-shadow:0 0 4px var(--accent);}
.pd-q.q-na{opacity:0.3;pointer-events:none;text-decoration:line-through;}

.gen-lang-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:1100;display:flex;align-items:center;justify-content:center;animation:fadeIn 0.2s;}
.gen-lang-modal{background:var(--bg-2);border:1px solid var(--border);border-radius:var(--radius-lg);padding:24px;max-width:360px;width:90%;text-align:center;}
.gen-lang-modal h3{margin-bottom:8px;font-size:16px;}
.gen-lang-modal p{font-size:12px;color:var(--text-3);margin-bottom:16px;}
.gen-lang-btns{display:flex;gap:10px;justify-content:center;}
.gen-lang-btn{flex:1;padding:14px 12px;border-radius:var(--radius);border:2px solid var(--border);background:var(--bg-3);cursor:pointer;transition:all .15s;font-size:13px;font-weight:600;color:var(--text);}
.gen-lang-btn:hover{border-color:var(--accent);background:var(--accent-soft);}
.gen-lang-btn .flag{font-size:24px;display:block;margin-bottom:6px;}

/* ═══ UTILITIES & ACCESSIBILITY ═══ */
.flex-end{display:flex;gap:6px;justify-content:flex-end;}
/* Diff — see diff section below */
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;}
.skip-link{position:absolute;top:-40px;left:0;background:var(--accent);color:#fff;padding:8px 16px;z-index:9999;font-size:14px;border-radius:0 0 var(--radius) 0;transition:top .2s;}
.skip-link:focus{top:0;}
*:focus-visible{outline:2px solid var(--accent);outline-offset:2px;border-radius:2px;}
.skcard:focus-visible{outline:2px solid var(--accent);outline-offset:2px;}
[role="dialog"]:focus{outline:none;}
/* Breadcrumb Navigation (HCD: ③認知負荷 ②使いやすさ) */
.breadcrumb{display:flex;align-items:center;gap:6px;font-size:11px;flex:1;overflow-x:auto;white-space:nowrap;}
.breadcrumb-link{background:none;border:none;color:var(--accent);cursor:pointer;padding:4px 6px;border-radius:4px;transition:all .15s;font-size:11px;}
.breadcrumb-link:hover{background:var(--accent-soft);text-decoration:underline;}
.breadcrumb-current{color:var(--text);font-weight:600;padding:4px 6px;}
.breadcrumb-sep{color:var(--text-3);font-size:10px;}

.prev-toolbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;}
.prev-toolbar-r{display:flex;gap:4px;}
.prev-nav-btn{min-width:28px;padding:2px 6px;}
.prev-nav-btn.disabled,.prev-nav-btn[aria-disabled="true"]{opacity:0.3;pointer-events:none;}
.view-nav{display:flex;gap:2px;}
.view-nav-btn{min-width:26px;padding:2px 5px;font-size:11px;}
.view-nav-btn.disabled,.view-nav-btn[aria-disabled="true"]{opacity:0.25;pointer-events:none;}
.empty-preview{color:var(--text-3);font-size:13px;text-align:center;margin-top:40px;}
.empty-preview-sm{color:var(--text-3);font-size:12px;text-align:center;margin-top:40px;}
.ft-separator{color:var(--border);font-size:10px;padding:6px 0;}
.road-summary{margin-top:12px;padding:12px;background:var(--bg-3);border-radius:var(--radius);font-size:12px;text-align:center;}
.exp-header{margin-bottom:12px;}
.exp-header h3{font-size:14px;margin-bottom:4px;}
.exp-header p{font-size:11px;color:var(--text-3);}
.exp-ranking{margin:12px 0;padding:12px;background:var(--bg-3);border-radius:var(--radius);border:1px solid var(--border);}
.exp-ranking h4{font-size:12px;margin-bottom:10px;color:var(--accent);}
.exp-rank-row{display:flex;align-items:center;justify-content:space-between;padding:6px 8px;border-radius:4px;cursor:pointer;transition:background .15s;}
.exp-rank-row:hover{background:var(--bg-2);}
.exp-rank-top{background:var(--bg-2);border:1px solid var(--accent);border-radius:6px;}
.exp-rank-left{display:flex;align-items:center;gap:8px;min-width:200px;}
.exp-rank-medal{font-size:14px;min-width:28px;text-align:center;}
.exp-rank-name{font-size:12px;font-weight:500;}
.exp-rank-right{display:flex;align-items:center;gap:8px;flex:1;max-width:200px;}
.exp-rank-bar{flex:1;height:6px;background:var(--bg-1);border-radius:3px;overflow:hidden;}
.exp-rank-bar-fill{height:100%;background:var(--accent);border-radius:3px;transition:width .3s;}
.exp-rank-score{font-size:11px;font-weight:600;color:var(--accent);min-width:36px;text-align:right;}
.exp-rank-reasons{display:flex;flex-wrap:wrap;gap:4px;margin:2px 0 6px 36px;}
.exp-rank-tag{font-size:10px;padding:1px 6px;background:var(--accent);color:#fff;border-radius:10px;opacity:0.8;}
.exp-metrics-sep{margin-top:10px;border-top:1px solid var(--border);padding-top:8px;}
/* ═══ AI LAUNCHER ═══ */
.launch-stats{display:flex;gap:12px;margin:12px 0;}
.launch-stat{flex:1;text-align:center;padding:10px;background:var(--bg-3);border:1px solid var(--border);border-radius:var(--radius);}
.launch-num{font-size:20px;font-weight:700;color:var(--accent);display:block;}
.launch-lbl{font-size:10px;color:var(--text-3);}
.launch-folders{margin:12px 0;padding:12px;background:var(--bg-3);border-radius:var(--radius);border:1px solid var(--border);}
.launch-folders h4{font-size:12px;margin-bottom:8px;}
.launch-folder-row{display:flex;align-items:center;gap:8px;padding:4px 0;font-size:11px;}
.launch-folder-row label{display:flex;align-items:center;gap:4px;min-width:120px;}
.launch-folder-row span{flex:1;text-align:right;color:var(--text-3);font-size:10px;min-width:140px;}
.launch-bar{flex:1;height:4px;background:var(--bg-1);border-radius:2px;max-width:80px;}
.launch-bar-fill{height:100%;background:var(--accent);border-radius:2px;}
.launch-models{margin:8px 0;padding:10px;background:var(--bg-3);border-radius:var(--radius);border:1px solid var(--border);}
.launch-models h4{font-size:12px;margin-bottom:6px;}
.launch-model-row{font-size:11px;padding:3px 0;display:flex;justify-content:space-between;}
.launch-model-pct{font-weight:600;font-size:10px;}
.launch-templates{margin:12px 0;}
.launch-templates h4{font-size:12px;margin-bottom:8px;}
.launch-tpl{display:flex;align-items:center;gap:10px;padding:10px 12px;background:var(--bg-3);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:6px;cursor:pointer;transition:border-color .15s,background .15s;}
.launch-tpl:hover{border-color:var(--accent);background:var(--bg-2);}
.launch-tpl-icon{font-size:22px;min-width:30px;text-align:center;}
.launch-tpl-info{display:flex;flex-direction:column;gap:2px;}
.launch-tpl-info strong{font-size:12px;}
.launch-tpl-info span{font-size:10px;color:var(--text-3);}
.launch-cat-bar{display:flex;flex-wrap:wrap;gap:4px;margin-bottom:10px;}
.launch-cat-btn{padding:4px 10px;border-radius:20px;font-size:10px;font-weight:600;background:var(--chip-bg);color:var(--text-3);border:1px solid var(--chip-border);cursor:pointer;transition:all .15s;}
.launch-cat-btn:hover{border-color:var(--accent);color:var(--accent);}
.launch-cat-btn.active{background:var(--accent-soft);color:var(--accent);border-color:var(--accent);}
.launch-rec-row{display:flex;flex-wrap:wrap;gap:6px;align-items:center;padding:8px 0;margin-bottom:8px;border-bottom:1px solid var(--border);}
.launch-rec-lbl{font-size:10px;font-weight:700;color:var(--text-3);text-transform:uppercase;letter-spacing:0.5px;}
.launch-rec-chip{padding:4px 10px;border-radius:20px;font-size:10px;font-weight:600;background:var(--accent-soft);color:var(--accent);border:1px solid color-mix(in srgb,var(--accent) 30%,transparent);cursor:pointer;transition:all .15s;}
.launch-rec-chip:hover{background:var(--accent);color:white;}
.launch-output{margin:12px 0;border:1px solid var(--accent);border-radius:var(--radius);overflow:hidden;}
.launch-output-head{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:var(--accent);color:#fff;}
.launch-output-head h4{margin:0;font-size:13px;}
.launch-output-meta{padding:6px 12px;font-size:10px;color:var(--text-3);background:var(--bg-3);border-bottom:1px solid var(--border);}
.launch-output-pre{padding:12px;font-size:11px;max-height:300px;overflow:auto;white-space:pre-wrap;word-break:break-word;background:var(--bg-1);margin:0;}
.launch-airec{font-size:0.65em;opacity:0.55;margin-left:auto;white-space:nowrap;padding:2px 5px;background:var(--bg-2);border-radius:4px;border:1px solid var(--border);}
.help-expert-hint{margin-top:8px;padding:8px;border-top:1px solid var(--border);background:var(--bg-3);border-radius:6px;}
.help-eh-head{display:flex;justify-content:space-between;align-items:center;font-weight:600;font-size:0.85em;margin-bottom:4px;}
.help-eh-text{font-size:0.85em;color:var(--text-2);line-height:1.5;}
.help-eh-next{background:none;border:none;cursor:pointer;font-size:1em;padding:0 4px;color:var(--text-2);}
.help-eh-next:hover{color:var(--accent);}
.help-eh-ctx{border-left:2px solid var(--accent);padding-left:6px;}
.help-eh-ctx .help-eh-head::after{content:'✨';font-size:.7em;margin-left:4px;opacity:.7;}

.diff-header{padding:8px 12px;border-bottom:1px solid var(--border);background:var(--bg-3);display:flex;justify-content:space-between;align-items:center;}
.diff-title{font-size:12px;font-weight:600;}
.diff-stats{font-size:11px;color:var(--text-3);}
.diff-stats .add{color:var(--success);}
.diff-stats .del{color:var(--danger);}
.diff-stats .btn{font-size:10px;margin-left:8px;}
.diff-body{font-family:monospace;font-size:11px;line-height:1.6;padding:8px;overflow-y:auto;max-height:calc(100vh - 200px);}
.diff-same{padding:1px 8px;color:var(--text-3);}
.diff-add{padding:1px 8px;background:color-mix(in srgb,var(--success) 9%,transparent);color:var(--success);}
.diff-del{padding:1px 8px;background:color-mix(in srgb,var(--danger) 9%,transparent);color:var(--danger);text-decoration:line-through;}
.diff-ln{display:inline-block;width:35px;text-align:right;margin-right:8px;}
.diff-same .diff-ln{opacity:0.5;}

.editor-toolbar{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;border-bottom:1px solid var(--border);background:var(--bg-3);}
.editor-toolbar .title{font-size:12px;font-weight:600;}
.editor-toolbar .actions{display:flex;gap:6px;}
.editor-toolbar .btn{font-size:11px;}
.editor-area{width:100%;height:calc(100% - 42px);border:none;outline:none;resize:none;background:var(--bg-1);color:var(--text);font-family:'Fira Code',monospace;font-size:12px;line-height:1.6;padding:12px;tab-size:2;box-sizing:border-box;}

.exp-dim{opacity:0.2;}
.exp-current{color:var(--accent);}
.exp-select h4{margin:0;}
.exp-win{color:var(--success);}
.exp-tie{color:var(--warn);}
/* ═══ POST-GEN GUIDE ═══ */
.guide-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.65);z-index:250;display:flex;align-items:center;justify-content:center;animation:fadeIn .3s;}
.guide-modal{background:var(--bg-2);border:1px solid var(--border);border-radius:16px;padding:28px;max-width:520px;width:92%;max-height:85vh;overflow-y:auto;box-shadow:0 24px 64px rgba(0,0,0,0.35);}
.guide-header{display:flex;align-items:center;gap:14px;margin-bottom:16px;position:relative;}
.guide-em{font-size:36px;}
.guide-title{font-size:18px;font-weight:800;letter-spacing:-0.02em;}
.guide-sub{font-size:12px;font-weight:600;}
div.guide-sub.guide-lv-b{background:none;color:var(--success);}
div.guide-sub.guide-lv-i{background:none;color:var(--warn);}
div.guide-sub.guide-lv-p{background:none;color:var(--danger);}
.guide-close{position:absolute;top:0;right:0;background:none;border:none;color:var(--text-3);font-size:18px;cursor:pointer;padding:4px 8px;border-radius:6px;}
.guide-close:hover{background:var(--bg-3);color:var(--text);}
.guide-badge{font-size:11px;color:var(--accent);background:var(--accent-soft);padding:6px 14px;border-radius:20px;text-align:center;margin-bottom:20px;font-weight:600;letter-spacing:0.02em;}
.guide-steps{display:flex;flex-direction:column;gap:14px;margin-bottom:20px;}
.guide-step{display:flex;gap:14px;padding:14px;background:var(--bg-3);border:1px solid var(--border);border-radius:12px;}
.guide-step-num{width:32px;height:32px;min-width:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:14px;}
.guide-step-title{font-size:13px;font-weight:700;margin-bottom:4px;}
.guide-step-desc{font-size:12px;color:var(--text-2);line-height:1.7;}
.guide-step-desc code{font-family:var(--mono);font-size:11px;background:var(--bg);padding:1px 5px;border-radius:4px;color:var(--accent-2);}
.guide-actions{display:flex;gap:10px;justify-content:flex-end;flex-wrap:wrap;}
.guide-prog{display:flex;align-items:center;gap:8px;margin-bottom:14px;}
.guide-prog-bar{flex:1;height:6px;background:var(--bg-3);border-radius:3px;overflow:hidden;}
.guide-prog-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--success));border-radius:3px;transition:width .4s;}
.guide-prog-txt{font-size:11px;font-weight:700;color:var(--accent);min-width:28px;text-align:right;}
.guide-ck{display:flex;align-items:center;flex-shrink:0;cursor:pointer;}
.guide-ck input{display:none;}
.guide-ckbox{width:20px;height:20px;min-width:20px;border-radius:5px;border:2px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;color:#fff;transition:all .15s;}
.guide-step-done .guide-ckbox{background:var(--success);border-color:var(--success);}
.guide-step-done .guide-step-title{text-decoration:line-through;opacity:0.6;}
.guide-step-done .guide-step-desc{opacity:0.5;}
.guide-lv-b{background:rgba(52,211,153,0.12);color:var(--success);}
.guide-lv-i{background:rgba(251,191,36,0.12);color:var(--warn);}
.guide-lv-p{background:rgba(251,113,133,0.12);color:var(--danger);}
/* ═══ PRINT ═══ */
@media print{
  :root{--bg:#fff;--bg-2:#fff;--bg-3:#f5f5f5;--bg-4:#eee;--text:#111;--text-2:#333;--text-3:#666;--border:#ccc;--accent:#2563eb;--success:#059669;--warn:#d97706;--danger:#dc2626;}
  body{background:#fff;color:#111;font-size:11pt;}
  .topbar,.pstrip,.mobtabs,.sidebar,.sb-iconbar,.tour-container,.guide-overlay,.help-overlay,.kb-overlay,.pm-overlay,.confirm-overlay,.toast-msg,.btn,.export-grid,.izone,.toc-panel,.edit-banner,.skipped-banner,.code-copy-btn,.table-copy-btn,.mermaid-copy-btn{display:none!important;}
  .panel-c,.panel-p{width:100%;border:none;overflow:visible;}
  .ws{flex-direction:column;overflow:visible;}
  .prev-body pre{border:1px solid #ccc;background:#f9f9f9;page-break-inside:avoid;}
  .md-rendered h1,.md-rendered h2,.md-rendered h3{page-break-after:avoid;}
  .md-rendered table{page-break-inside:avoid;}
  a{color:#2563eb;text-decoration:underline;}
  .prev-head{background:#fff;border-bottom:2px solid #111;}
}
/* Audit Results */
.audit-results{background:var(--bg-s);border:1px solid var(--bd);border-radius:var(--radius);padding:12px;margin-top:8px;}
.audit-results h4{margin:0 0 8px;font-size:13px;color:var(--fg);}
.audit-summary-err,.audit-summary-warn,.audit-summary-info{display:inline-block;font-size:11px;padding:2px 8px;border-radius:10px;margin-right:6px;margin-bottom:6px;}
.audit-summary-err{background:color-mix(in srgb,var(--danger) 12%,transparent);color:var(--danger);}
.audit-summary-warn{background:color-mix(in srgb,var(--warn) 12%,transparent);color:var(--warn-text,#b45309);}
.audit-summary-info{background:color-mix(in srgb,var(--accent) 12%,transparent);color:var(--accent);}
/* Custom Preset Chip */
.prchip-custom{border-style:dashed;opacity:.8;}
.prchip-custom.sel{opacity:1;border-color:var(--accent);background:var(--bg-2);}
/* Theme Overlay Panel */
.theme-overlay-panel{margin-top:8px;padding:10px 14px;border:1px dashed var(--border-light);border-radius:var(--radius);background:color-mix(in srgb,var(--accent) 4%,transparent);display:none;}
.theme-overlay-title{font-size:11px;font-weight:600;color:var(--text-2);margin-bottom:8px;letter-spacing:.02em;}
.theme-chips{display:flex;flex-wrap:wrap;gap:6px;}
.theme-chip{padding:4px 12px;border-radius:16px;font-size:11px;font-weight:600;background:var(--chip-bg);color:var(--text-2);border:1px solid var(--chip-border);cursor:pointer;transition:all .15s;}
.theme-chip:hover{border-color:var(--accent-2);color:var(--accent-2);}
.theme-chip.selected{background:color-mix(in srgb,var(--accent-2) 15%,transparent);color:var(--accent-2);border-color:var(--accent-2);}
/* TECH_DB Browser Modal */
.techdb-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:9999;display:flex;align-items:center;justify-content:center;}
.techdb-modal{background:var(--bg-1);border-radius:12px;width:min(90vw,700px);max-height:80vh;display:flex;flex-direction:column;box-shadow:0 8px 32px rgba(0,0,0,.3);}
.techdb-hd{padding:16px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px;}
.techdb-hd h3{margin:0;flex:1;}
.techdb-search{padding:6px 10px;border-radius:6px;border:1px solid var(--border);background:var(--bg-2);color:var(--text);width:180px;}
.techdb-body{display:flex;flex:1;overflow:hidden;min-height:300px;}
.techdb-cats{width:160px;overflow-y:auto;border-right:1px solid var(--border);padding:8px;}
.techdb-cat{padding:6px 10px;border-radius:6px;cursor:pointer;font-size:.85em;margin-bottom:2px;}
.techdb-cat:hover,.techdb-cat.sel{background:var(--accent);color:#fff;}
.techdb-items{flex:1;overflow-y:auto;padding:12px;display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:8px;align-content:start;}
.techdb-item{padding:8px 12px;border:1px solid var(--border);border-radius:8px;cursor:pointer;transition:all .15s;}
.techdb-item:hover{border-color:var(--accent);background:var(--bg-2);}
.techdb-item b{display:block;margin-bottom:4px;}
.techdb-req,.techdb-price{font-size:.75em;opacity:.7;margin-right:8px;}
.btn-tech-browse{margin-top:8px;opacity:.7;}
.btn-tech-browse:hover{opacity:1;}

/* View Transition Animations (HCD: ⑤感情体験) */
.phase-exit{animation:phaseExitAnim .2s ease-out forwards;}
.phase-enter{animation:phaseEnterAnim .3s ease-out;}
@keyframes phaseExitAnim{from{opacity:1;transform:translateY(0);}to{opacity:0;transform:translateY(-20px);}}
@keyframes phaseEnterAnim{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}

/* Save Indicator (HCD: ⑥文脈適合) */
.save-indicator{position:fixed;top:20px;right:20px;font-size:24px;opacity:0;pointer-events:none;transition:opacity .2s;z-index:999;}
.save-indicator-show{opacity:1;animation:saveFlash .8s ease-out;}
@keyframes saveFlash{0%{transform:scale(1);opacity:1;}50%{transform:scale(1.2);opacity:1;}100%{transform:scale(1);opacity:0;}}

/* What's New Dot (HCD: C継続利用) */
.whats-new-dot{position:absolute;top:-4px;right:-4px;width:10px;height:10px;background:var(--danger);border-radius:50%;border:2px solid var(--bg-1);animation:dotPulse 2s infinite;}
@keyframes dotPulse{0%,100%{transform:scale(1);opacity:1;}50%{transform:scale(1.2);opacity:0.8;}}

/* AI Quick Start Card (GAP1: post-gen AI workflow) */
.ai-quickstart{background:var(--bg-2);border:1px solid var(--accent);border-radius:10px;padding:14px 16px;margin:10px 0;}
.ai-qs-title{font-weight:700;margin-bottom:10px;color:var(--accent);}
.ai-qs-flow{display:flex;align-items:center;gap:6px;flex-wrap:wrap;margin-bottom:10px;}
.ai-qs-step{display:flex;align-items:center;gap:4px;background:var(--bg-1);border-radius:6px;padding:4px 8px;font-size:.85em;}
.ai-qs-num{font-weight:700;color:var(--accent);}
.ai-qs-arrow{color:var(--text);opacity:.4;}
.ai-qs-steps{display:grid;gap:4px;margin-bottom:8px;}
.ai-qs-detail{font-size:.82em;padding:4px 8px;background:var(--bg-1);border-radius:6px;border-left:2px solid var(--accent);}
.ai-qs-note{font-size:.8em;opacity:.7;border-top:1px solid var(--border);padding-top:8px;margin-top:4px;}
.ai-qs-micro-label{font-size:.82em;font-weight:600;color:var(--accent);opacity:.85;margin-bottom:6px;}
.ai-qs-detail-micro{display:flex;align-items:flex-start;gap:6px;}
/* C3: AI context recovery prompts */
.ai-qs-recovery{margin-top:8px;border-top:1px solid var(--border);padding-top:6px;}
.ai-qs-recovery summary{font-size:.8em;cursor:pointer;opacity:.7;user-select:none;}
.ai-qs-recovery summary:hover{opacity:1;}
.ai-qs-rp-list{display:grid;gap:4px;margin-top:6px;}
.ai-qs-rp{display:flex;align-items:center;justify-content:space-between;gap:8px;background:var(--bg-1);border-radius:6px;padding:4px 8px;}
.ai-qs-rp-lbl{font-size:.8em;flex:1;}
/* F6: AI context recovery — expanded variant for Lv0-1 */
.ai-qs-recovery-open{margin-top:8px;padding:8px 12px;border:1px solid var(--border);border-radius:8px;background:var(--bg-2);}
.ai-qs-recovery-title{font-weight:600;margin-bottom:6px;font-size:.88em;}
/* G2-6: Lv4+ Power Ops panel */
.power-ops-panel{margin:12px 0;padding:10px 14px;background:var(--bg-2);border:1px solid var(--border);border-left:3px solid var(--accent);border-radius:8px;}
.power-ops-title{font-size:.85em;font-weight:700;margin-bottom:8px;color:var(--accent);}
.power-ops-btns{display:flex;flex-wrap:wrap;gap:6px;}
/* F7: sidebar all-files collapse */
.sb-all-collapse summary.ft-section-header{cursor:pointer;user-select:none;display:list-item;}
.sb-all-collapse summary:hover{opacity:.8;}
/* C2: ZIP urgent emphasis for Lv0-1 */
.export-hero-urgent{border:2px solid var(--accent);box-shadow:0 0 12px color-mix(in srgb,var(--accent) 30%,transparent);animation:heroUrgentPulse 2.5s ease-in-out infinite;}
.export-hero-urgent-label{background:var(--accent);color:#fff;font-size:.8em;font-weight:700;text-align:center;padding:4px 8px;border-radius:6px 6px 0 0;margin:-14px -16px 10px;letter-spacing:.03em;}
@keyframes heroUrgentPulse{0%,100%{box-shadow:0 0 8px color-mix(in srgb,var(--accent) 25%,transparent);}50%{box-shadow:0 0 18px color-mix(in srgb,var(--accent) 50%,transparent);}}
/* C1: Start Here 3-file spotlight */
.start-here-card{background:var(--bg-2);border:1px solid var(--success,#22c55e);border-radius:10px;padding:12px 14px;margin:8px 0;}
.start-here-title{font-weight:700;color:var(--success,#22c55e);margin-bottom:8px;font-size:.9em;}
.start-here-file{display:flex;align-items:center;gap:10px;padding:7px 8px;border-radius:7px;cursor:pointer;transition:background .15s;}
.start-here-file:hover{background:var(--bg-1);}
.start-here-icon{font-size:1.2em;flex-shrink:0;}
.start-here-info{display:flex;flex-direction:column;flex:1;min-width:0;}
.start-here-name{font-weight:600;font-size:.88em;font-family:monospace;}
.start-here-desc{font-size:.78em;opacity:.7;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.start-here-arr{opacity:.4;flex-shrink:0;}
/* Toast warn variant */
.toast-msg.toast-warn{border-color:var(--warn,#d97706);background:color-mix(in srgb,var(--warn,#d97706) 10%,var(--bg-3));}
/* Accessibility: Reduced Motion (HCD: A アクセシビリティ) */
@media(prefers-reduced-motion:reduce){
  *,*::before,*::after{
    animation-duration:0.01ms!important;
    animation-iteration-count:1!important;
    transition-duration:0.01ms!important;
    scroll-behavior:auto!important;
  }
}
/* Phase G1: Lv2 guide bridge */
.guide-bridge{margin:14px 0 6px;padding:12px;background:var(--bg-3);border-radius:10px;border:1px solid var(--border);}
.guide-bridge-title{font-size:11px;font-weight:700;color:var(--text-2);margin-bottom:10px;letter-spacing:.4px;text-transform:uppercase;}
.guide-bridge-cards{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;}
.guide-bridge-card{background:var(--bg-2);border:1px solid var(--border);border-radius:8px;padding:10px 8px;cursor:pointer;text-align:left;transition:border-color .2s,transform .15s;width:100%;}
.guide-bridge-card:hover{border-color:var(--accent);transform:translateY(-2px);}
.bridge-icon{font-size:1.4em;display:block;margin-bottom:4px;}
.bridge-name{font-size:12px;font-weight:700;color:var(--text);margin-bottom:3px;}
.bridge-why{font-size:11px;color:var(--text-2);line-height:1.4;}
/* Phase G2: Lv3 dashboard shortcuts */
.dash-shortcuts{display:flex;flex-direction:column;gap:6px;padding:4px 0 8px;}
.dash-sc-row{display:flex;align-items:center;gap:10px;}
.dash-sc-key{background:var(--bg-3);border:1px solid var(--border);border-bottom-width:2px;border-radius:5px;padding:2px 8px;font-size:11px;font-family:monospace;color:var(--text);white-space:nowrap;}
.dash-sc-desc{font-size:12px;color:var(--text-2);}
/* Phase G4: Lv4 pillar export */
.dash-pex-grid{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px;}
.dash-pex-btn{font-size:12px!important;display:flex!important;align-items:center;gap:5px;}
.dash-pex-cnt{background:var(--bg-3);border-radius:4px;padding:1px 5px;font-size:10px;font-weight:700;color:var(--text-2);}

/* Phase J: Field Preset Mode */
.preset-mode-toggle{display:flex;gap:6px;padding:8px 0 6px;border-bottom:1px solid var(--border);margin-bottom:8px;}
.preset-mode-btn{background:var(--bg-3);border:1px solid var(--border);border-radius:20px;padding:5px 14px;font-size:12px;cursor:pointer;color:var(--text-2);transition:background .15s,border-color .15s,color .15s;}
.preset-mode-btn.active,.preset-mode-btn:hover{background:var(--accent);border-color:var(--accent);color:#fff;}
.scale-selector{display:flex;gap:4px;padding:4px 0 6px;flex-wrap:wrap;justify-content:center;}
.scale-btn{background:var(--bg-3);border:1px solid var(--border);border-radius:16px;padding:4px 10px;font-size:11px;cursor:pointer;color:var(--text-2);white-space:nowrap;transition:background .15s,border-color .15s,color .15s;}
.scale-btn.active,.scale-btn:hover{background:var(--accent-2,var(--accent));border-color:var(--accent);color:#fff;}
.field-cat-bar{display:flex;gap:4px;padding:4px 0 6px;flex-wrap:wrap;width:100%;justify-content:center;}
.field-cat-btn{background:var(--bg-3);border:1px solid var(--border);border-radius:16px;padding:4px 10px;font-size:11px;cursor:pointer;color:var(--text-2);white-space:nowrap;transition:background .15s,border-color .15s,color .15s;}
.field-cat-btn.active,.field-cat-btn:hover{background:var(--bg-2);border-color:var(--accent);color:var(--text);}

/* Preset Suggest */
.preset-suggest-wrap{margin-bottom:8px;position:relative;}
.preset-suggest-in{width:100%;padding:10px 14px;border:1.5px solid var(--border);border-radius:8px;background:var(--bg-2);color:var(--text);font-size:.95rem;outline:none;transition:border .2s;box-sizing:border-box;}
.preset-suggest-in:focus{border-color:var(--accent);}
.preset-suggest-in::placeholder{color:var(--text-2);opacity:.7;}
.preset-suggest-clear{position:absolute;right:10px;top:50%;transform:translateY(-50%);background:none;border:none;color:var(--text-3);font-size:18px;cursor:pointer;padding:2px 6px;line-height:1;z-index:2;transition:color 0.15s;}.preset-suggest-clear:hover{color:var(--text);}
.preset-suggest-box{display:none;position:absolute;left:0;right:0;z-index:99;margin-top:4px;border:1px solid var(--border);border-radius:8px;background:var(--bg-2);overflow:hidden;box-shadow:0 4px 16px rgba(0,0,0,.25);}
.ps-item{display:flex;align-items:center;gap:8px;padding:8px 12px;cursor:pointer;transition:background .15s;}
.ps-item:hover,.ps-item:focus{background:var(--bg-3);outline:none;}
.ps-badge-field,.ps-badge-std{font-size:.75rem;flex-shrink:0;}
.ps-name{font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:180px;}
.ps-desc{color:var(--text-2);font-size:.82rem;flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.ps-score{font-size:.72rem;color:var(--accent);font-weight:700;flex-shrink:0;}
.ps-empty{padding:12px;text-align:center;color:var(--text-2);font-size:.85rem;}
