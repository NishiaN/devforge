# DevForge v9.5 — 完全ガイド
## AIを使って「設計ゼロ」からプロダクト開発を加速する

> **対象読者**: 個人開発者・スタートアップCTO・AIツールを活用したい開発者・ノーコード寄りの実装者
> **読了時間**: 約20分（通読） / 作業時間: 初回30〜60分で最初の生成完了

---

## 目次

1. [①基礎概念](#①基礎概念--devforgeとは何か)
2. [②準備](#②準備--使い始める前に)
3. [③手順](#③手順--ゼロからファイル生成まで)
4. [④応用](#④応用--生成ファイルをaiに投入して開発する)
5. [⑤よくある失敗](#⑤よくある失敗--ハマりポイントと対処法)
6. [⑥まとめ](#⑥まとめ--次の一歩)

---

## ①基礎概念 — DevForgeとは何か

### 1-1. 一言で言うと

**「質問に答えるだけで、AIが読める開発設計書を135+ファイル自動生成するツール」**

コードは一行も書かない。ブラウザで動作する単一HTMLファイル。インストール不要。

---

### 1-2. なぜ必要か — 2026年の「コンテキスト断片化」問題

AI開発ツール（Cursor / Claude Code / Windsurf / GitHub Copilot）が普及した結果、皮肉にも新しい問題が生まれた。

```
月曜: CursorでNext.jsの認証を実装 → コードが生成された
水曜: Claudeにデータベース設計を依頼 → 別のスキーマが出てきた
金曜: Windsurf でAPIエンドポイントを追加 → 3つのスキーマが矛盾
```

**どのAIも「あなたのプロジェクト全体」を知らない。** 毎回「私のアプリはこういう設計で、技術スタックはこれで、認証はこうで……」と説明し直す必要がある。

DevForgeはこの問題を解決する：

```
DevForgeで一度設計を整理
    ↓
135+ファイルの「AIが読む設計書」を自動生成
    ↓
すべてのAIツールが「このプロジェクトの全体像」を即座に理解
    ↓
矛盾のない一貫した開発が継続できる
```

---

### 1-3. 何を生成するか — 20の柱（Pillar）

DevForgeは**20カテゴリ（柱）**の設計書・設定ファイルを生成する。

| # | カテゴリ | 主な生成物 |
|---|---------|-----------|
| ① | SDD仕様書 | プロジェクト憲法・機能仕様・技術計画・タスク・検証計画 |
| ② | DevContainer | devcontainer.json・Dockerfile・docker-compose・post-create.sh |
| ③ | MCP | project-context.md（AIコンテキスト管理ファイル） |
| ④ | AIルール | CLAUDE.md・.cursorrules・.windsurfrules・AGENTS.md |
| ⑤ | 品質インテリジェンス | QA戦略・テストマトリクス・バグ防止・インシデント対応 |
| ⑦ | ロードマップ | 学習パス・スプリント計画・WBS |
| ⑨ | デザインシステム | デザイントークン・コンポーネント定義・Anti-AIチェックリスト |
| ⑩ | リバースエンジニアリング | アーキテクチャ解析・依存関係マップ |
| ⑪ | 実装インテリジェンス | 32ドメイン別実装パターン・AI運用手順 |
| ⑫ | セキュリティインテリジェンス | OWASP対応・脅威モデル・コンプライアンスマトリクス |
| ⑬ | 戦略インテリジェンス | 業種別ブループリント・テックレーダー・市場分析 |
| ⑭ | 運用インテリジェンス | SLO/SLI・Ops Runbook・フィーチャーフラグ設計 |
| ⑮ | 未来戦略 | 2026-2030規制予測・ESG・エコシステム戦略 |
| ⑯ | 開発IQ | 32ドメイン別開発メソドロジー・フェーズ別AIプロンプト |
| ⑰ | プロンプトゲノム | 8軸評価フレームワーク・AIマチュリティモデル |
| ⑱ | Prompt Ops | ReActワークフロー・LLMOpsダッシュボード・プロンプトレジストリ |
| ⑲ | エンタープライズ | マルチテナントアーキテクチャ・承認ワークフロー・管理画面仕様 |
| ⑳ | CI/CD | パイプライン設計・デプロイ戦略・品質ゲートマトリクス |
| ⑧ | AIプロンプトランチャー | 37種のAI向け構造化プロンプト（仕様レビュー・MVP実装など） |
| (共通) | 共通ファイル | README・ER図・API設計・画面設計・CI/CD YAML など |

**合計: 135+ ファイル**（プロジェクト設定により変動）

---

### 1-4. 使用者目線 vs 開発者目線

| 視点 | 主な用途 | 必要な知識 |
|------|---------|-----------|
| **使用者（アプリ開発者）** | 自分のアプリ設計書を生成してAIに渡す | プログラミング知識は不要。質問に答えるだけ |
| **開発者（DevForge自体を改造）** | 新ピラー追加・新プリセット作成・ドメイン拡張 | JavaScript（Vanilla）、Node.js、テスト（node:test）|

本ガイドは**両方の視点**を扱う。まず「使用者」として使いこなし、必要なら「開発者」として拡張する。

---

## ②準備 — 使い始める前に

### 2-1. 動作環境

#### 使用者として使う場合（インストール一切不要）

```
必要なもの：
✅ モダンブラウザ（Chrome / Firefox / Edge / Safari 最新版）
✅ devforge-v9.html（単一ファイル）
❌ Node.js 不要
❌ npm 不要
❌ インターネット接続 不要（CDN機能のみ除く）
```

`devforge-v9.html` を**ダブルクリックして開く**だけで動作する。

#### 開発者として改造・ビルドする場合

```bash
# 必要環境
Node.js v18以上（v20 LTS推奨）
npm v8以上

# セットアップ
git clone https://github.com/NishiaN/devforge.git
cd devforge-v9
npm install

# ビルド（src/ → devforge-v9.html）
node build.js

# テスト（550テスト）
npm test

# 開発サーバー起動（ホットリロードなし、手動ビルド）
npm run dev          # build + live-server port 3000
npm run open         # build + open in browser

# 単一テストファイルの実行
node --test test/snapshot.test.js
```

---

### 2-2. スキルレベルの設定

DevForgeには**7段階のスキルレベルシステム**がある。最初に自分のレベルを選ぶことで、質問の難易度・選択肢・生成されるドキュメントの詳細度が自動調整される。

| レベル | 称号 | 説明 | 主な違い |
|-------|------|------|---------|
| Lv.0 | 🔰 完全初心者 | HTML/CSSを触り始めた | saasプリセット強制、Firebase自動設定、最小限の質問 |
| Lv.1 | 🌱 入門者 | プログラミング基礎は理解 | beginner向け選択肢、6個のKPIチップ |
| Lv.2 | 🚀 始めたばかり | 小さなアプリを作ったことがある | 8個のKPIチップ、少し広い選択肢 |
| Lv.3 | ⚡ 中級者 | React/Node.jsで開発経験あり | 全intermediate選択肢、10個のKPIチップ |
| Lv.4 | 🔥 上級者 | フルスタック開発経験あり | 確認ダイアログスキップ、上級選択肢 |
| Lv.5 | 💎 エキスパート | 本番環境経験・チームリード | pro全選択肢（Go/Python/Kubernetes等）|
| Lv.6 | 👑 伝道者 | 技術コミュニティへの貢献 | エバンジェリストセクション生成 |

**スキルレベル設定の場所**: トップ画面の3つのカード（初心者/中級者/プロ）の下にある**スライダー**でLv.0〜6を細かく設定できる。

> **Tip**: 迷ったら Lv.1（初心者カードを選択）から始める。いつでも変更可能。

---

### 2-3. 言語設定

画面右上のフラグボタンで**日本語 / English** を切り替えられる。

- **UIの言語**: 質問・ボタン・ヘルプテキストの表示言語
- **生成ファイルの言語**: 生成ボタンを押す直前に「日本語/英語どちらで生成するか」を選べる。UIとは独立して設定可能。

---

### 2-4. プリセットの選択肢を把握する（41種）

白紙から始める前に、あなたのプロジェクトに近いプリセットを選ぶと設定が大幅に時短できる。

<details>
<summary>プリセット一覧（クリックで展開）</summary>

| カテゴリ | プリセット |
|---------|-----------|
| **AIアプリ** | AIエージェント、AIコンテンツ生成、チャットボット |
| **ビジネスSaaS** | SaaSアプリ、ワークフロー自動化、ダッシュボード、開発者ツール |
| **EC・決済** | ECサイト、マーケットプレイス、フィンテック、建設業決済 |
| **コミュニティ・コンテンツ** | コミュニティ、CMS/ブログ、ニュースレター/メディア、クリエイターエコノミー |
| **教育・学習** | 学習プラットフォーム(LMS)、家庭教師マッチング |
| **医療・健康** | ヘルステック、クリニック・医院、動物病院 |
| **業務システム** | HR/採用管理、ヘルプデスク、ナレッジベース、不動産管理、契約管理、現場サービス |
| **予約・イベント** | 予約システム、イベントプラットフォーム、飲食店管理 |
| **モバイル・Web** | PWAアプリ、ポートフォリオ、Link in Bio |
| **テック** | IoTダッシュボード、リアルタイムコラボ、ゲーミフィケーション |
| **新興** | CRM、SNS/ソーシャル、物流トラッキング、アンケート/フォーム、求人プラットフォーム |
| **カスタム** | 完全カスタム（自由入力） |

</details>

---

## ③手順 — ゼロからファイル生成まで

### 全体フロー

```
[画面起動]
    ↓
[スキルレベル選択] ←── Lv.0〜6 スライダー
    ↓
[プリセット選択] ←── 41種 or カスタム
    ↓
[Phase 1: プロジェクト定義]  (5問)
[Phase 2: 技術選定]          (10〜14問、スキルLvにより変動)
[Phase 3: 機能・データ設計]  (8問)
    ↓
[生成言語選択: 日本語 or English]
    ↓
[🚀 生成ボタン] → 20ステップで135+ファイル生成（約10〜30秒）
    ↓
[ファイルプレビュー・確認]
    ↓
[エクスポート: ZIP / JSON / PDF / AI向けMD]
    ↓
[AIツール（Cursor・Claude・Windsurf）へ投入]
```

---

### 3-1. Phase 1: プロジェクト定義（5問）

最初のフェーズ。プロジェクトの「何を作るか」を定義する。

#### 質問①: プロジェクトの目的（purpose）
チップを選択するか自由入力。

```
例: 「地元農家と消費者をつなぐマーケットプレイス」
例: 「社内の技術ノウハウを蓄積・検索できるナレッジベース」
例: 「フリーランス向けの請求書作成・管理SaaS」
```
> **ポイント**: 「誰が何をできるようになるか」を一文で書く。この内容からDevForgeが**32ドメイン**（ec/saas/fintech/educationなど）を自動推定し、以降の質問・KPI・生成内容がカスタマイズされる。

#### 質問②: ターゲットユーザー（target）
複数選択可。「学生」「フリーランス」「中小企業」「エンジニア」など。具体的なペルソナをイメージして選ぶ。

#### 質問③: 成功指標・KPI（success）
目的に応じて自動提案されるKPIチップ群から3〜5つを選ぶ。

```
ECなら: 💰 GMV月100万円 / 💰 CV率3%+ / 🏪 カート放棄30%以下
SaaSなら: 💰 月売上10万円(MRR) / 🔄 月間チャーン5%以下 / 🔄 DAU/MAU比率30%+
```

#### 質問④: スコープ外（scope_out）
「やらないこと」を明確に定義する。これが最も重要な質問のひとつ。

```
悪い例: 何も選ばない（スコープが無限に広がる）
良い例: 「チャット機能」「動画配信」「ネイティブアプリ」「多言語対応」を外す
```
> **なぜ重要か**: AIにこれを伝えると「それは今回作りません」という回答が得られる。スコープ外を定義しないプロジェクトは必ず機能追加地獄に陥る。

#### 質問⑤: リリース目標（deadline）
2週間/1ヶ月/3ヶ月/6ヶ月から選ぶ。生成されるWBS・タスク一覧のスプリント数に影響する。

---

### 3-2. Phase 2: 技術選定（10〜14問）

スキルレベルによって表示される選択肢が変わる。迷ったら**推奨（Recommended）**マークのついた選択肢を選べば問題ない。

#### フロントエンド（frontend）

| 選択肢 | 向いている人 | Lv要件 |
|-------|------------|--------|
| React + Next.js | ほぼ全員（デファクト） | Lv.0〜 |
| React (Vite SPA) | 管理画面・SaaS | Lv.0〜 |
| Vue 3 + Nuxt | 日本コミュニティ活用 | Lv.2〜 |
| Svelte + SvelteKit | 最小バンドル重視 | Lv.2〜 |
| Astro | コンテンツサイト・静的 | Lv.2〜 |
| Angular | エンタープライズ大規模 | Lv.5〜 |

#### バックエンド/DB（backend）— 最重要の選択

| 選択肢 | 特徴 | 推奨Lv |
|-------|------|--------|
| **Firebase** | Googleが運営するBaaS。コード不要で最速プロトタイプ | Lv.0〜1 |
| **Supabase** | OSS版PostgreSQL BaaS。SQLが使える。急成長中 | Lv.0〜3 |
| Node.js + Express | 最も実績あり。柔軟性高い | Lv.2〜 |
| Node.js + Fastify | Expressの5倍高速 | Lv.3〜 |
| Python + FastAPI | AI/ML連携が必要な場合 | Lv.4〜 |

> **初心者へ**: Firebaseを選ぶとORMの質問がスキップされ、質問数が減る。最初はFirebaseかSupabaseを推奨。

#### AIコーディングツール（ai_tools）

「AI自律開発レベル」で「なし」以外を選んだ場合に表示される。

```
Cursor（IDE統合）+ Claude Code（CLI）の組み合わせが最強
```

生成されるAIルールファイルが選択したツールに最適化される。

#### デプロイ先（deploy）

| 選択肢 | 特徴 |
|-------|------|
| Vercel | Next.js最適、無料枠充実 |
| Firebase Hosting | Firebase統合 |
| Cloudflare Pages | エッジ最速 |
| Railway | フルスタック簡単デプロイ |
| AWS | フルカスタム（Lv.5〜） |

---

### 3-3. Phase 3: 機能・データ設計（8問）

#### MVP機能（mvp_features）— 3〜5個に絞る
「ユーザー登録・ログイン」「ダッシュボード」「一覧表示・検索」「作成・編集・削除」が基本セット。

> **重要**: ここでの選択順序が`tasks.md`のスプリント優先順位に直接影響する。Drag & Drop で並び替えられる（sortable）。上にあるほど高優先度として生成される。

#### データテーブル（data_entities）
英語・単数形で入力。例: `User, Product, Order, Review`

DevForgeは事前定義された**ENTITY_COLUMNS**から自動的にカラム定義・FK関係・RLSポリシーを生成する。

```
User       → id, email, name, avatar_url, created_at
Product    → id, name, description, price, stock, category_id
Order      → id, user_id, total_amount, status, created_at
```

#### 認証方式（auth）
メール/パスワード・Google OAuth・GitHub OAuth・Magic Linkが基本。複数選択可。

---

### 3-4. 生成実行

すべての回答が完了すると「🚀 生成」ボタンが有効になる（サイドバー内）。

ボタンを押すと**生成言語選択モーダル**が表示される:
- 🇯🇵 **日本語**: 生成ドキュメントすべて日本語
- 🇺🇸 **English**: 生成ドキュメントすべて英語

> **Note**: UIの言語と生成言語は独立している。日本語UIで英語ドキュメントを生成することも可能。

生成が始まると：
1. **izone**に20個のピラーカードが表示され、順次アニメーション
2. **サイドバー**の5×4ピラーアイコングリッドも同期してリアルタイム更新
3. 約10〜30秒で全ステップ完了

---

### 3-5. 生成後の確認

#### サイドバー — ファイルツリー
生成完了後、サイドバーが「ファイル」タブに自動切替。

- **ピン留め**: よく見るファイルをピン
- **最近**: 直近5ファイル
- **全ファイル**: フォルダ別ツリー
- **検索**: ファイル名フィルタ

#### ピラーアイコングリッド（サイドバー内）
生成完了後、20個のアイコンが緑になる。クリックするとその柱のピラータブに切り替わり、代表ファイルが自動プレビュー表示される。

#### プレビューパネル
MarkdownはHTMLレンダリング、Mermaidはダイアグラム表示。**編集モード**に切り替えてその場で修正も可能。修正したファイルには `✏️` マークがつく（差分確認ボタンあり）。

---

### 3-6. エクスポート

#### 推奨: ZIP ダウンロード
```
📦 ZIP ダウンロード
全135+ファイルを一括ダウンロード。プロジェクトフォルダにそのまま展開して使う。
```

#### バックアップ: JSON エクスポート
```
📤 JSON エクスポート
設定（回答内容）+ 全生成ファイルをJSONで保存。
後でインポートすれば完全復元できる。
```

> ⚠️ **必ずローカル保存すること**: DevForgeはブラウザのLocalStorage（最大4MB）にのみ保存する。ブラウザのキャッシュをクリアするとデータが消える。

#### その他のエクスポート形式

| 形式 | 用途 |
|-----|------|
| 📄 PDF印刷 | 仕様書を印刷・共有 |
| 📋 全ファイルコピー | テキスト結合してAIに貼り付け |
| 🤖 AI向けMD | TOC付きMarkdown（AI投入最適化版） |

---

### 3-7. 開発者向け: ビルドと拡張

```bash
# src/内を編集したらこのサイクルを繰り返す
# 1. ソース編集 (src/ 配下)
vim src/generators/p20-cicd.js

# 2. テスト実行（550テスト）
npm test

# 3. ビルド（src/ → devforge-v9.html）
node build.js
# → ✅ Built devforge-v9.html (1874KB, 55 modules)

# 4. ブラウザで確認
npm run open
```

**ビルドの制約**:
- ファイルサイズ上限: 2000KB（超えると`process.exit(1)`）
- 現在: ~1874KB（余裕: 約126KB）
- `node build.js --no-minify`: デバッグ用（ミニファイしない）
- `node build.js --report`: サイズ内訳を表示

**モジュール追加時のルール**:
```javascript
// build.js の jsFiles 配列への追加順序が重要
// core → data → generators → ui → init の順を守る
'generators/p21-xxxxx.js',  // generatorsの最後に追加
```

---

## ④応用 — 生成ファイルをAIに投入して開発する

### 4-1. AIプロンプトランチャーの使い方

生成完了後、**ピラー⑧（AIプロンプトランチャー）**タブを開く。

```
手順:
1. [ランチャー]タブを開く
2. フォルダ別トークン数を確認（左パネル）
3. 37テンプレートから目的に合うものを選ぶ
4. 「コピー」ボタンでプロンプトをコピー
5. AIツール（Claude / Cursor / Windsurf）に貼り付けて実行
```

プロンプトには**プロジェクトコンテキスト**が自動注入される:
```markdown
# Context
Project: 農産物マーケットプレイス
Stack: React + Next.js + Supabase (PostgreSQL)
Auth: Supabase Auth, Google OAuth
Entities: User, Listing, Category, Order, Transaction, Review, Message
```

#### 37テンプレート早見表

| フェーズ | テンプレート | 推奨AI | 用途 |
|---------|------------|--------|-----|
| **設計確認** | 🔍 仕様レビュー | Gemini | 4ステップ構造化レビュー |
| **設計確認** | 📐 アーキテクチャ整合性 | Gemini | レイヤー違反・技術方針チェック |
| **実装** | 🚀 MVP実装 | Copilot | tasks.mdから最優先1件を実装 |
| **実装** | 🔌 API統合 | Copilot | 型安全クライアントコード生成 |
| **テスト** | 🧪 テスト生成 | Copilot | Vitest形式のテストファイル作成 |
| **改善** | ♻️ リファクタ提案 | Gemini | SOLID違反検出・工数見積付き |
| **改善** | ⚡ パフォーマンス最適化 | Gemini | NFR目標比較・ボトルネック特定 |
| **品質** | 🔒 セキュリティ監査 | Claude | OWASP Top 10チェック |
| **品質** | ♿ アクセシビリティ監査 | Claude | WCAG 2.1 AA 4原則チェック |
| **デバッグ** | 🐛 QA・バグ検出 | Copilot | ドメイン別バグパターン分析 |
| **デバッグ** | 🔧 デバッグ支援 | Copilot | 5 Whys分析・修正コード |
| **ドキュメント** | 📝 ドキュメント補完 | Claude | ギャップ分析+最重要docを全文生成 |
| **ドキュメント** | 🌍 国際化実装 | Claude | 翻訳キー抽出・JSON生成・t()置換 |
| **アイデア** | 🎭 9人の専門家ブレスト | ChatGPT | 9ペルソナ×3軸評価でアイデア発散 |
| **アイデア** | 🎯 UXジャーニー設計 | Claude | Lv.0-5段階的開示・3つの悪夢回避 |
| **戦略** | 🤖 AIモデル選択 | Claude | 開発フェーズ別AIツール最適化 |
| **戦略** | 🏭 業種分析 | Gemini | 業種別ブループリント・テックレーダー |
| **高度** | 🧬 プロンプトゲノム分析 | Claude | 8軸評価でプロンプト品質改善 |
| **高度** | 🔬 UX熟練度監査 | Claude | 7段階レベル別UXギャップ分析 |

---

### 4-2. AIツール別の投入戦略

#### Cursor / Windsurf（IDE）への投入

```bash
# ZIPを展開してプロジェクトルートに配置
unzip devforge-output.zip -d my-project/

# CLAUDE.md / .cursorrules が自動読み込まれる
# → AIが「このプロジェクトは何か」を即座に理解する

# 開発開始
cd my-project
cursor .   # Cursorで開く
```

Cursorが読み込む主要ファイル:
```
.cursorrules          → プロジェクト全体のルール
.cursor/rules/        → パス別の詳細ルール（spec/frontend/backend/test/ops）
docs/01_architecture.md → アーキテクチャ概要
.spec/constitution.md → プロジェクト憲法（最重要）
```

#### Claude Code（CLI）への投入

```bash
# CLAUDE.md が自動読み込まれる
claude                # プロジェクトルートで起動するだけ

# 最初のプロンプト例
"tasks.mdの最優先タスクを実装してください。
 .spec/technical-plan.mdのDB設計に従い、
 docs/07_api_design.mdのAPI仕様に合わせてください。"
```

#### ChatGPT / Gemini（Web）への投入

```
AIプロンプトランチャーで「全ファイルコピー」または「AI向けMD」を選択
→ コピーしたテキストをChatGPTに貼り付け
→ 最初のメッセージ: 「このプロジェクト設計書を理解してください。質問を待ちます。」
```

---

### 4-3. スキルレベル別の活用戦略

#### Lv.0〜1 (完全初心者・入門者) の進め方

```
1. プリセット選択（saasかlmsが導入しやすい）
2. Phase 1の質問に日本語で自由入力
3. Phase 2: FE=React+Next.js, BE=Firebase（デフォルトのまま）
4. Phase 3: MVP機能は3個だけ選ぶ
5. 生成後: README.md と .spec/constitution.md を最初に読む
6. AIランチャー「🚀 MVP実装」を使ってCursorにタスクを渡す
```

#### Lv.3〜4 (中級者・上級者) の進め方

```
1. カスタムプリセットで詳細に設定
2. ai_auto = 「エージェント型開発」か「マルチAgent協調」を選択
3. 生成後: docs/フォルダ全体を確認し、CI/CDパイプラインを設定
4. AIランチャーで「🔍 仕様レビュー」→「📐 アーキテクチャ整合性」を実行
5. .github/workflows/ci.yml をGitHubにpushしてCI構築
```

#### Lv.5〜6 (エキスパート・伝道者) の進め方

```
1. pro選択肢フル活用（Go/Python/Kubernetes/OAuth SSO/MFA）
2. ai_auto = 「フル自律開発」または「オーケストレーター」
3. docs/73-76 エンタープライズアーキテクチャを確認
4. docs/77-80 CI/CDインテリジェンスを本番パイプラインに反映
5. AIランチャー「🧬 プロンプトゲノム分析」でプロンプト最適化
6. コミュニティにノウハウを共有（docs/42にエバンジェリストセクション生成）
```

---

### 4-4. 差分確認・再生成

#### 差分確認（Diff View）
ファイルプレビュー右上の「🔄 差分」ボタンで、前回生成との差分をUnified Diff形式で確認できる。

#### 部分再生成
「🔄 再生成」ボタンを押すと全ファイルを再生成。`S.prevFiles`に前回のスナップショットが保存されるため差分確認が可能。

#### ファイル編集後の保護
編集したファイル（`✏️`マーク）は再生成時に上書きされる。編集内容を残したい場合は**必ずZIPでバックアップ**してから再生成すること。

---

### 4-5. コマンドパレット（Ctrl+K）

`Ctrl+K`で開くコマンドパレットから頻繁な操作にアクセスできる:

```
> ZIP ダウンロード
> 再生成
> 言語を英語に切り替え
> Pillar ⑨ デザインシステム
> docs/07 API設計 を開く
```

---

### 4-6. 開発者向け: 新ピラー追加の手順

DevForge自体に新しい生成機能を追加したい場合の6ステップ:

```
Step 1: src/generators/p21-xxxxx.js を作成
        → PIPELINE_STAGES/TEMPLATES等のデータ定義
        → gen〇〇() 関数の実装（const G = S.genLang==='ja';で始める）

Step 2: build.js の jsFiles 配列に追加
        → generators/p20-cicd.js の後に追加

Step 3: src/generators/index.js の steps 配列に追加
        → {fn:()=>gen〇〇(a,pn), lbl:'柱㉑ XXX', err:'P21'}

Step 4: src/ui/preview.js の buildFileTree() に
        else if(pillar===20){...} を追加

Step 5: src/ui/sidebar.js の PILLAR_FIRST_FILE[20] にファイルパスを追加

Step 6: test/ にテストファイル作成 → npm test で全テスト通過確認
```

---

## ⑤よくある失敗 — ハマりポイントと対処法

### ❌ 失敗1: 生成ボタンが押せない / 生成が始まらない

**原因**: 必須項目（フロントエンド・バックエンド・データベース）が未回答

```
チェックリスト:
□ Phase 2: フロントエンドを選択した
□ Phase 2: バックエンドを選択した
□ Phase 2: データベースを選択した（バックエンドが「なし」でなければ）
□ プロジェクト名を入力した（画面上部の入力欄）
```

---

### ❌ 失敗2: ブラウザを閉じたらデータが消えた

**原因**: LocalStorageには容量制限（4MB）がある。また、ブラウザの設定によってはキャッシュクリア時に消える。

```
対策（必ずやること）:
✅ 生成直後に 📦 ZIP ダウンロード
✅ 生成直後に 📤 JSON エクスポート
✅ プロジェクトをgitリポジトリに保存
```

LocalStorageのサイズ警告は4MBを超えると自動表示される。多くのファイルを生成・編集した場合は容量に注意。

---

### ❌ 失敗3: AIがプロジェクト内容を理解してくれない

**原因**: AIに渡すファイルの選択が間違っている、または順番が悪い

```
正しい投入順序:
1. まず .spec/constitution.md（プロジェクト憲法）を読ませる
2. 次に CLAUDE.md または AI_BRIEF.md（約1200トークン、軽量版）
3. 必要に応じて docs/01_architecture.md（アーキテクチャ概要）
4. 作業内容に応じた個別ファイル（docs/07_api_design.md など）

❌ 悪い例: ZIPを全部貼り付ける（コンテキスト超過でAIが混乱）
✅ 良い例: AIランチャーの「🤖 AI向けMD」でTOC付きに整形して渡す
```

---

### ❌ 失敗4: 「技術スタックの互換性エラー」が出る

**原因**: 相性の悪い技術の組み合わせを選択した（58のcompatルールが検出）

```
よくある組み合わせエラー例:
❌ Flutter + NextAuth/Auth.js → Flutterにはサポートされない
❌ Django + Netlify → フルサーバーはNetlifyの制限に引っかかる
❌ React Native + Web専用ライブラリ

対処法:
1. 警告メッセージに「自動修正」ボタンがある場合はクリック
2. なければ警告を読んで該当の選択を変更
3. 「このまま生成するか？」の確認ダイアログで続行も可能
```

---

### ❌ 失敗5: 生成ファイルの内容がプロジェクトと合わない

**原因**: プロジェクト目的（purpose）の入力が曖昧すぎる

```
❌ 悪い例: 「便利なアプリを作りたい」
✅ 良い例: 「農家と消費者をつなぐ産直マーケットプレイス。
            農家は野菜を出品し、消費者が直接購入できる。
            Stripeで決済、Supabaseでリアルタイム在庫管理」

目的の記述が詳しいほど:
- ドメイン推定の精度が上がる（marketplace/fintech/ec等）
- KPIの提案内容が最適化される
- エンティティ定義が自動補完される
- セキュリティ要件が業種別に調整される
```

---

### ❌ 失敗6: プロジェクトが「機能追加地獄」に陥る

**原因**: スコープ外（scope_out）を定義しなかった

```
症状:
- 「チャット機能も欲しい」「多言語対応も」「モバイルアプリも」...
- AIが毎回違うアーキテクチャを提案してくる
- どこまで作ればリリースできるのか分からない

対処法:
1. DevForgeでscope_outに「チャット機能」「多言語対応」「ネイティブアプリ」を追加
2. .spec/constitution.md の「スコープ外」セクションをAIに読ませる
3. 「それは今回のスコープ外です。Phase 2で検討します」とAIに伝える根拠を持つ
```

---

### ❌ 失敗7: セキュリティ対策が不十分なまま本番公開

**原因**: 生成されたセキュリティドキュメントを無視した

```
見落とされがちなファイル:
- docs/43_security_intelligence.md → OWASP 2025対応チェックリスト
- docs/44_threat_model.md → 脅威モデル（データフロー図付き）
- docs/45_compliance_matrix.md → GDPR/個人情報保護法対応
- docs/46_ai_security.md → AI特有のリスク（プロンプトインジェクションなど）

本番公開前の必須チェック:
□ RLSポリシーをすべてのテーブルに適用したか
□ API認証（Bearer Token / API Key）を実装したか
□ 入力バリデーションをサーバーサイドで実装したか
□ 環境変数(.env)にシークレットを移動したか
```

---

### ❌ 失敗8: 「コードが動かない」でAIに丸投げする

**原因**: デバッグの手順が体系化されていない

```
正しい手順（AIランチャー「🔧 デバッグ支援」テンプレートを活用）:

1. エラーメッセージを error_logs.md に記録
2. DevForgeのAIランチャー「🔧 デバッグ支援」を開く
3. 生成されたプロンプト（error_logs.md参照済み）をAIに投入
4. 「5 Whys分析」で根本原因を特定
5. 修正コードを実装し、エラーログにクローズ記録
```

---

### ❌ 失敗9: 開発者向け — テストが壊れる

**原因**: ファイルを追加・変更したが関連するテストを更新しなかった

```
変更時にテスト更新が必要なパターン:

変更内容                    → 更新すべきテストファイル
─────────────────────────────────────────────────────
新ピラー追加                → test/build.test.js（関数存在確認）
                              test/gen-coherence.test.js（生成テスト）
新プリセット追加            → test/presets.test.js（件数 41+n）
新ドメイン追加              → test/data-coverage.test.js
互換性ルール追加            → test/compat.test.js（ルール件数更新）
KB（キーボードショートカット）追加 → src/index.html + src/core/i18n.js（同期必須）
ツアーステップ追加          → test/build.test.js（ステップ数アサーション）
```

---

### ❌ 失敗10: 開発者向け — ビルドサイズが2000KBを超える

**原因**: 大量のデータ定数を追加した

```
対処法:
1. node build.js --report でどのモジュールが大きいか確認
2. 圧縮定数の活用（_U/_SA/_T/_D など common.js の圧縮パターン参照）
3. docs/CLAUDE-REFERENCE.md の「Compression Patterns」セクションを読む
4. 現状 ~1874KB / 2000KB 上限（余裕: ~126KB）

警告ライン:
~1900KB: 警告表示
~2000KB: process.exit(1)でビルド失敗
```

---

## ⑥まとめ — 次の一歩

### DevForgeが解決する3つの問題

| 問題 | DevForgeの解決策 |
|-----|----------------|
| **コンテキスト断片化**: AIが毎回プロジェクトを忘れる | CLAUDE.md/.cursorrules/AGENTS.md等でAIが常に全体像を把握 |
| **設計書不在**: コードだけあって設計がない | 135+ファイルの構造化ドキュメントを自動生成 |
| **AI活用の非効率**: プロンプトが毎回アドホック | 37種の構造化プロンプトテンプレートで再現性のあるAI活用 |

---

### あなたの次のアクション

#### 今日やること（30分）

```
✅ devforge-v9.html を開く
✅ スキルレベルを設定（スライダー）
✅ 最も近いプリセットを選択
✅ 質問に答える（Phase 1〜3）
✅ 🚀 生成ボタンを押す
✅ ZIPをダウンロードして保存
✅ .spec/constitution.md を読む（プロジェクトの全体像把握）
```

#### 今週やること

```
✅ ZIPをプロジェクトフォルダに展開
✅ Cursor / Claude Code でプロジェクトフォルダを開く
✅ AIランチャー「🔍 仕様レビュー」でプロジェクト品質確認
✅ AIランチャー「🚀 MVP実装」で最初の機能を実装開始
✅ .github/workflows/ci.yml をpushしてCI構築
```

#### 今月やること

```
✅ docs/43_security_intelligence.md のチェックリスト完了
✅ docs/77_cicd_pipeline_design.md のパイプライン構築
✅ MVP機能を本番環境にデプロイ
✅ 最初のユーザーにフィードバックを受ける
✅ フィードバックを元にDevForgeで「再生成」してドキュメント更新
```

---

### 数字で見るDevForge v9.5

| 指標 | 数値 |
|-----|-----|
| 生成ファイル数 | **135+** ファイル |
| 柱（生成カテゴリ）数 | **20** 柱 |
| プリセット数 | **41** 種類 |
| 対応ドメイン数 | **32** ドメイン |
| AIプロンプトテンプレート | **37** テンプレート |
| 技術互換性チェックルール | **58** ルール |
| スキルレベル | **7** 段階 (Lv.0〜6) |
| テスト数 | **550** テスト（全パス） |
| ビルドサイズ | **~1874KB**（単一HTML） |
| 対応AIツール | Cursor, Claude Code, Windsurf, Cline, GitHub Copilot, Devin |

---

### 開発者としてDevForgeを改造したい方へ

```
参照すべきドキュメント:
📘 CLAUDE.md              → コア開発ルール・クリティカルな注意点
📙 docs/CLAUDE-REFERENCE.md → 詳細データ構造・新ピラー追加6ステップ
📕 docs/CLAUDE-TROUBLESHOOTING.md → 環境構築・デプロイ・トラブルシュート

最初に読むべきコード:
src/core/state.js         → グローバル状態S・save()/load()/esc()
src/generators/common.js  → detectDomain()/getEntityColumns()/inferER()
src/generators/index.js   → 20ステップの生成エンジン全体像
src/ui/sidebar.js         → UI連携パターンの参考
```

---

> **DevForge v9.5** — *AIの時代の「設計から実装まで」を一気通貫でサポートするAI駆動開発OSです。*
> 思考を整理し、設計を可視化し、AIに的確に指示する。
> その出発点がここにあります。

---

*最終更新: 2026-02-20 | バージョン: v9.5 | テスト: 550 / Build: ~1874KB*
